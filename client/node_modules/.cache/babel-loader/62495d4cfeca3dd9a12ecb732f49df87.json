{"ast":null,"code":"/**\r\n * DevExtreme (ui/text_box/ui.text_editor.mask.strategy.base.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\n\nvar _index = require(\"../../events/utils/index\");\n\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar MASK_EVENT_NAMESPACE = \"dxMask\";\nvar BLUR_EVENT = \"blur beforedeactivate\";\nvar EMPTY_CHAR = \" \";\n\nvar BaseMaskStrategy = function () {\n  function BaseMaskStrategy(editor) {\n    this.editor = editor;\n    this.DIRECTION = {\n      FORWARD: \"forward\",\n      BACKWARD: \"backward\"\n    };\n    this.NAME = this._getStrategyName();\n  }\n\n  var _proto = BaseMaskStrategy.prototype;\n\n  _proto._getStrategyName = function () {\n    return \"base\";\n  };\n\n  _proto.editorOption = function () {\n    var _this$editor;\n\n    return (_this$editor = this.editor).option.apply(_this$editor, arguments);\n  };\n\n  _proto.editorInput = function () {\n    return this.editor._input();\n  };\n\n  _proto.editorCaret = function (newCaret) {\n    if (!newCaret) {\n      return this.editor._caret();\n    }\n\n    this.editor._caret(newCaret);\n  };\n\n  _proto.getHandler = function (handlerName) {\n    var handler = this[\"_\".concat(handlerName, \"Handler\")] || function () {};\n\n    return handler.bind(this);\n  };\n\n  _proto.attachEvents = function () {\n    var _this = this;\n\n    var $input = this.editorInput();\n    this.getHandleEventNames().forEach(function (eventName) {\n      var subscriptionName = (0, _index.addNamespace)(eventName.toLowerCase(), MASK_EVENT_NAMESPACE);\n\n      _events_engine.default.on($input, subscriptionName, _this.getEventHandler(eventName));\n    });\n\n    this._attachChangeEventHandlers();\n  };\n\n  _proto.getHandleEventNames = function () {\n    return [\"focusIn\", \"focusOut\", \"keyDown\", \"input\", \"paste\", \"cut\", \"drop\"];\n  };\n\n  _proto.getEventHandler = function (eventName) {\n    return this[\"_\".concat(eventName, \"Handler\")].bind(this);\n  };\n\n  _proto.detachEvents = function () {\n    _events_engine.default.off(this.editorInput(), \".\".concat(MASK_EVENT_NAMESPACE));\n  };\n\n  _proto._attachChangeEventHandlers = function () {\n    if ((0, _array.inArray)(\"change\", this.editorOption(\"valueChangeEvent\").split(\" \")) === -1) {\n      return;\n    }\n\n    _events_engine.default.on(this.editorInput(), (0, _index.addNamespace)(BLUR_EVENT, MASK_EVENT_NAMESPACE), function (e) {\n      this._suppressCaretChanging(this._changeHandler, [e]);\n\n      this._changeHandler(e);\n    }.bind(this.editor));\n  };\n\n  _proto._focusInHandler = function () {\n    this.editor._showMaskPlaceholder();\n\n    this.editor._direction(this.DIRECTION.FORWARD);\n\n    if (!this.editor._isValueEmpty() && this.editorOption(\"isValid\")) {\n      this.editor._adjustCaret();\n    } else {\n      var caret = this.editor._maskRulesChain.first();\n\n      this._caretTimeout = setTimeout(function () {\n        this._caret({\n          start: caret,\n          end: caret\n        });\n      }.bind(this.editor), 0);\n    }\n  };\n\n  _proto._focusOutHandler = function (event) {\n    this.editor._changeHandler(event);\n\n    if (\"onFocus\" === this.editorOption(\"showMaskMode\") && this.editor._isValueEmpty()) {\n      this.editorOption(\"text\", \"\");\n\n      this.editor._renderDisplayText(\"\");\n    }\n  };\n\n  _proto._cutHandler = function (event) {\n    var caret = this.editorCaret();\n    var selectedText = this.editorInput().val().substring(caret.start, caret.end);\n\n    this.editor._maskKeyHandler(event, function () {\n      return (0, _dom.clipboardText)(event, selectedText);\n    });\n  };\n\n  _proto._dropHandler = function () {\n    this._clearDragTimer();\n\n    this._dragTimer = setTimeout(function () {\n      this.option(\"value\", this._convertToValue(this._input().val()));\n    }.bind(this.editor));\n  };\n\n  _proto._clearDragTimer = function () {\n    clearTimeout(this._dragTimer);\n  };\n\n  _proto._keyDownHandler = function () {\n    this._keyPressHandled = false;\n  };\n\n  _proto._pasteHandler = function (event) {\n    var editor = this.editor;\n    this._keyPressHandled = true;\n    var caret = this.editorCaret();\n\n    editor._maskKeyHandler(event, function () {\n      var pastedText = (0, _dom.clipboardText)(event);\n\n      var restText = editor._maskRulesChain.text().substring(caret.end);\n\n      var accepted = editor._handleChain({\n        text: pastedText,\n        start: caret.start,\n        length: pastedText.length\n      });\n\n      var newCaret = caret.start + accepted;\n\n      editor._handleChain({\n        text: restText,\n        start: newCaret,\n        length: restText.length\n      });\n\n      editor._caret({\n        start: newCaret,\n        end: newCaret\n      });\n    });\n  };\n\n  _proto._autoFillHandler = function (event) {\n    var _this2 = this;\n\n    var editor = this.editor;\n    var inputVal = this.editorInput().val();\n    this._inputHandlerTimer = setTimeout(function () {\n      _this2._keyPressHandled = true;\n\n      if (_this2._isAutoFill()) {\n        _this2._keyPressHandled = true;\n\n        editor._maskKeyHandler(event, function () {\n          editor._handleChain({\n            text: inputVal,\n            start: 0,\n            length: inputVal.length\n          });\n        });\n\n        editor._validateMask();\n      }\n    });\n  };\n\n  _proto._isAutoFill = function () {\n    var $input = this.editor._input();\n\n    var result = false;\n\n    if (_browser.default.msie && _browser.default.version > 11) {\n      result = $input.hasClass(\"edge-autofilled\");\n    } else {\n      if (_browser.default.webkit) {\n        var input = $input.get(0);\n        result = input && input.matches(\":-webkit-autofill\");\n      }\n    }\n\n    return result;\n  };\n\n  _proto.runWithoutEventProcessing = function (action) {\n    var keyPressHandled = this._keyPressHandled;\n    this._keyPressHandled = true;\n    action();\n    this._keyPressHandled = keyPressHandled;\n  };\n\n  _proto._backspaceHandler = function () {};\n\n  _proto._delHandler = function (event) {\n    var editor = this.editor;\n    this._keyPressHandled = true;\n\n    editor._maskKeyHandler(event, function () {\n      return !editor._hasSelection() && editor._handleKey(EMPTY_CHAR);\n    });\n  };\n\n  _proto.clean = function () {\n    this._clearDragTimer();\n\n    clearTimeout(this._backspaceHandlerTimeout);\n    clearTimeout(this._caretTimeout);\n    clearTimeout(this._inputHandlerTimer);\n  };\n\n  return BaseMaskStrategy;\n}();\n\nexports.default = BaseMaskStrategy;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/ui/text_box/ui.text_editor.mask.strategy.base.js"],"names":["exports","default","_events_engine","_interopRequireDefault","require","_index","_browser","_array","_dom","obj","__esModule","MASK_EVENT_NAMESPACE","BLUR_EVENT","EMPTY_CHAR","BaseMaskStrategy","editor","DIRECTION","FORWARD","BACKWARD","NAME","_getStrategyName","_proto","prototype","editorOption","_this$editor","option","apply","arguments","editorInput","_input","editorCaret","newCaret","_caret","getHandler","handlerName","handler","concat","bind","attachEvents","_this","$input","getHandleEventNames","forEach","eventName","subscriptionName","addNamespace","toLowerCase","on","getEventHandler","_attachChangeEventHandlers","detachEvents","off","inArray","split","e","_suppressCaretChanging","_changeHandler","_focusInHandler","_showMaskPlaceholder","_direction","_isValueEmpty","_adjustCaret","caret","_maskRulesChain","first","_caretTimeout","setTimeout","start","end","_focusOutHandler","event","_renderDisplayText","_cutHandler","selectedText","val","substring","_maskKeyHandler","clipboardText","_dropHandler","_clearDragTimer","_dragTimer","_convertToValue","clearTimeout","_keyDownHandler","_keyPressHandled","_pasteHandler","pastedText","restText","text","accepted","_handleChain","length","_autoFillHandler","_this2","inputVal","_inputHandlerTimer","_isAutoFill","_validateMask","result","msie","version","hasClass","webkit","input","get","matches","runWithoutEventProcessing","action","keyPressHandled","_backspaceHandler","_delHandler","_hasSelection","_handleKey","clean","_backspaceHandlerTimeout","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/text_box/ui.text_editor.mask.strategy.base.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _events_engine = _interopRequireDefault(require(\"../../events/core/events_engine\"));\r\nvar _index = require(\"../../events/utils/index\");\r\nvar _browser = _interopRequireDefault(require(\"../../core/utils/browser\"));\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar MASK_EVENT_NAMESPACE = \"dxMask\";\r\nvar BLUR_EVENT = \"blur beforedeactivate\";\r\nvar EMPTY_CHAR = \" \";\r\nvar BaseMaskStrategy = function() {\r\n    function BaseMaskStrategy(editor) {\r\n        this.editor = editor;\r\n        this.DIRECTION = {\r\n            FORWARD: \"forward\",\r\n            BACKWARD: \"backward\"\r\n        };\r\n        this.NAME = this._getStrategyName()\r\n    }\r\n    var _proto = BaseMaskStrategy.prototype;\r\n    _proto._getStrategyName = function() {\r\n        return \"base\"\r\n    };\r\n    _proto.editorOption = function() {\r\n        var _this$editor;\r\n        return (_this$editor = this.editor).option.apply(_this$editor, arguments)\r\n    };\r\n    _proto.editorInput = function() {\r\n        return this.editor._input()\r\n    };\r\n    _proto.editorCaret = function(newCaret) {\r\n        if (!newCaret) {\r\n            return this.editor._caret()\r\n        }\r\n        this.editor._caret(newCaret)\r\n    };\r\n    _proto.getHandler = function(handlerName) {\r\n        var handler = this[\"_\".concat(handlerName, \"Handler\")] || function() {};\r\n        return handler.bind(this)\r\n    };\r\n    _proto.attachEvents = function() {\r\n        var _this = this;\r\n        var $input = this.editorInput();\r\n        this.getHandleEventNames().forEach(function(eventName) {\r\n            var subscriptionName = (0, _index.addNamespace)(eventName.toLowerCase(), MASK_EVENT_NAMESPACE);\r\n            _events_engine.default.on($input, subscriptionName, _this.getEventHandler(eventName))\r\n        });\r\n        this._attachChangeEventHandlers()\r\n    };\r\n    _proto.getHandleEventNames = function() {\r\n        return [\"focusIn\", \"focusOut\", \"keyDown\", \"input\", \"paste\", \"cut\", \"drop\"]\r\n    };\r\n    _proto.getEventHandler = function(eventName) {\r\n        return this[\"_\".concat(eventName, \"Handler\")].bind(this)\r\n    };\r\n    _proto.detachEvents = function() {\r\n        _events_engine.default.off(this.editorInput(), \".\".concat(MASK_EVENT_NAMESPACE))\r\n    };\r\n    _proto._attachChangeEventHandlers = function() {\r\n        if ((0, _array.inArray)(\"change\", this.editorOption(\"valueChangeEvent\").split(\" \")) === -1) {\r\n            return\r\n        }\r\n        _events_engine.default.on(this.editorInput(), (0, _index.addNamespace)(BLUR_EVENT, MASK_EVENT_NAMESPACE), function(e) {\r\n            this._suppressCaretChanging(this._changeHandler, [e]);\r\n            this._changeHandler(e)\r\n        }.bind(this.editor))\r\n    };\r\n    _proto._focusInHandler = function() {\r\n        this.editor._showMaskPlaceholder();\r\n        this.editor._direction(this.DIRECTION.FORWARD);\r\n        if (!this.editor._isValueEmpty() && this.editorOption(\"isValid\")) {\r\n            this.editor._adjustCaret()\r\n        } else {\r\n            var caret = this.editor._maskRulesChain.first();\r\n            this._caretTimeout = setTimeout(function() {\r\n                this._caret({\r\n                    start: caret,\r\n                    end: caret\r\n                })\r\n            }.bind(this.editor), 0)\r\n        }\r\n    };\r\n    _proto._focusOutHandler = function(event) {\r\n        this.editor._changeHandler(event);\r\n        if (\"onFocus\" === this.editorOption(\"showMaskMode\") && this.editor._isValueEmpty()) {\r\n            this.editorOption(\"text\", \"\");\r\n            this.editor._renderDisplayText(\"\")\r\n        }\r\n    };\r\n    _proto._cutHandler = function(event) {\r\n        var caret = this.editorCaret();\r\n        var selectedText = this.editorInput().val().substring(caret.start, caret.end);\r\n        this.editor._maskKeyHandler(event, function() {\r\n            return (0, _dom.clipboardText)(event, selectedText)\r\n        })\r\n    };\r\n    _proto._dropHandler = function() {\r\n        this._clearDragTimer();\r\n        this._dragTimer = setTimeout(function() {\r\n            this.option(\"value\", this._convertToValue(this._input().val()))\r\n        }.bind(this.editor))\r\n    };\r\n    _proto._clearDragTimer = function() {\r\n        clearTimeout(this._dragTimer)\r\n    };\r\n    _proto._keyDownHandler = function() {\r\n        this._keyPressHandled = false\r\n    };\r\n    _proto._pasteHandler = function(event) {\r\n        var editor = this.editor;\r\n        this._keyPressHandled = true;\r\n        var caret = this.editorCaret();\r\n        editor._maskKeyHandler(event, function() {\r\n            var pastedText = (0, _dom.clipboardText)(event);\r\n            var restText = editor._maskRulesChain.text().substring(caret.end);\r\n            var accepted = editor._handleChain({\r\n                text: pastedText,\r\n                start: caret.start,\r\n                length: pastedText.length\r\n            });\r\n            var newCaret = caret.start + accepted;\r\n            editor._handleChain({\r\n                text: restText,\r\n                start: newCaret,\r\n                length: restText.length\r\n            });\r\n            editor._caret({\r\n                start: newCaret,\r\n                end: newCaret\r\n            })\r\n        })\r\n    };\r\n    _proto._autoFillHandler = function(event) {\r\n        var _this2 = this;\r\n        var editor = this.editor;\r\n        var inputVal = this.editorInput().val();\r\n        this._inputHandlerTimer = setTimeout(function() {\r\n            _this2._keyPressHandled = true;\r\n            if (_this2._isAutoFill()) {\r\n                _this2._keyPressHandled = true;\r\n                editor._maskKeyHandler(event, function() {\r\n                    editor._handleChain({\r\n                        text: inputVal,\r\n                        start: 0,\r\n                        length: inputVal.length\r\n                    })\r\n                });\r\n                editor._validateMask()\r\n            }\r\n        })\r\n    };\r\n    _proto._isAutoFill = function() {\r\n        var $input = this.editor._input();\r\n        var result = false;\r\n        if (_browser.default.msie && _browser.default.version > 11) {\r\n            result = $input.hasClass(\"edge-autofilled\")\r\n        } else {\r\n            if (_browser.default.webkit) {\r\n                var input = $input.get(0);\r\n                result = input && input.matches(\":-webkit-autofill\")\r\n            }\r\n        }\r\n        return result\r\n    };\r\n    _proto.runWithoutEventProcessing = function(action) {\r\n        var keyPressHandled = this._keyPressHandled;\r\n        this._keyPressHandled = true;\r\n        action();\r\n        this._keyPressHandled = keyPressHandled\r\n    };\r\n    _proto._backspaceHandler = function() {};\r\n    _proto._delHandler = function(event) {\r\n        var editor = this.editor;\r\n        this._keyPressHandled = true;\r\n        editor._maskKeyHandler(event, function() {\r\n            return !editor._hasSelection() && editor._handleKey(EMPTY_CHAR)\r\n        })\r\n    };\r\n    _proto.clean = function() {\r\n        this._clearDragTimer();\r\n        clearTimeout(this._backspaceHandlerTimeout);\r\n        clearTimeout(this._caretTimeout);\r\n        clearTimeout(this._inputHandlerTimer)\r\n    };\r\n    return BaseMaskStrategy\r\n}();\r\nexports.default = BaseMaskStrategy;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}