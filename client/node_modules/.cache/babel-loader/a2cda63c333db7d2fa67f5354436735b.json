{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment_form.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.AppointmentForm = exports.APPOINTMENT_FORM_GROUP_NAMES = void 0;\n\nvar _form = _interopRequireDefault(require(\"../form\"));\n\nvar _date_serialization = _interopRequireDefault(require(\"../../core/utils/date_serialization\"));\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _devices = _interopRequireDefault(require(\"../../core/devices\"));\n\nvar _data_source = _interopRequireDefault(require(\"../../data/data_source\"));\n\nvar _utils = _interopRequireDefault(require(\"./timezones/utils.timezones_data\"));\n\nvar _extend = require(\"../../core/utils/extend\");\n\nrequire(\"./ui.scheduler.recurrence_editor\");\n\nrequire(\"../text_area\");\n\nrequire(\"../tag_box\");\n\nrequire(\"../switch\");\n\nrequire(\"../select_box\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar SCREEN_SIZE_OF_SINGLE_COLUMN = 600;\nvar APPOINTMENT_FORM_GROUP_NAMES = {\n  Main: \"mainGroup\",\n  Recurrence: \"recurrenceGroup\"\n};\nexports.APPOINTMENT_FORM_GROUP_NAMES = APPOINTMENT_FORM_GROUP_NAMES;\nvar SchedulerAppointmentForm = {\n  _appointmentForm: {},\n  _lockDateShiftFlag: false,\n  _validateAppointmentFormDate: function (editor, value, previousValue) {\n    var isCurrentDateCorrect = null === value || !!value;\n    var isPreviousDateCorrect = null === previousValue || !!previousValue;\n\n    if (!isCurrentDateCorrect && isPreviousDateCorrect) {\n      editor.option(\"value\", previousValue);\n    }\n  },\n  _getAllDayStartDate: function (startDate) {\n    return new Date(new Date(startDate).setHours(0, 0, 0, 0));\n  },\n  _getAllDayEndDate: function (startDate) {\n    return new Date(new Date(startDate).setDate(startDate.getDate() + 1));\n  },\n  _getStartDateWithStartHour: function (startDate, startDayHour) {\n    return new Date(new Date(startDate).setHours(startDayHour));\n  },\n  create: function (componentCreator, $container, isReadOnly, formData) {\n    this._appointmentForm = componentCreator($container, _form.default, {\n      items: this._editors,\n      readOnly: isReadOnly,\n      showValidationSummary: true,\n      scrollingEnabled: true,\n      colCount: \"auto\",\n      colCountByScreen: {\n        lg: 2,\n        xs: 1\n      },\n      formData: formData,\n      showColonAfterLabel: false,\n      labelLocation: \"top\",\n      screenByWidth: function (width) {\n        return width < SCREEN_SIZE_OF_SINGLE_COLUMN || \"desktop\" !== _devices.default.current().deviceType ? \"xs\" : \"lg\";\n      }\n    });\n    return this._appointmentForm;\n  },\n  _dateBoxValueChanged: function (args, dateExpr, isNeedCorrect) {\n    this._validateAppointmentFormDate(args.component, args.value, args.previousValue);\n\n    var value = _date_serialization.default.deserializeDate(args.value);\n\n    var previousValue = _date_serialization.default.deserializeDate(args.previousValue);\n\n    var dateEditor = this._appointmentForm.getEditor(dateExpr);\n\n    var dateValue = _date_serialization.default.deserializeDate(dateEditor.option(\"value\"));\n\n    if (!this._appointmentForm._lockDateShiftFlag && dateValue && value && isNeedCorrect(dateValue, value)) {\n      var duration = previousValue ? dateValue.getTime() - previousValue.getTime() : 0;\n      dateEditor.option(\"value\", new Date(value.getTime() + duration));\n    }\n  },\n  _createTimezoneEditor: function (timeZoneExpr, secondTimeZoneExpr, visibleIndex, colSpan, isMainTimeZone) {\n    var _this = this;\n\n    var isShow = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : false;\n\n    var noTzTitle = _message.default.format(\"dxScheduler-noTimezoneTitle\");\n\n    return {\n      dataField: timeZoneExpr,\n      editorType: \"dxSelectBox\",\n      visibleIndex: visibleIndex,\n      colSpan: colSpan,\n      label: {\n        text: \" \"\n      },\n      editorOptions: {\n        displayExpr: \"title\",\n        valueExpr: \"id\",\n        placeholder: noTzTitle,\n        searchEnabled: true,\n        onValueChanged: function (args) {\n          var form = _this._appointmentForm;\n          var secondTimezoneEditor = form.getEditor(secondTimeZoneExpr);\n\n          if (isMainTimeZone) {\n            secondTimezoneEditor.option(\"value\", args.value);\n          }\n        }\n      },\n      visible: isShow\n    };\n  },\n  _createDateBoxEditor: function (dataExpr, colSpan, firstDayOfWeek, label, callback) {\n    return {\n      dataField: dataExpr,\n      editorType: \"dxDateBox\",\n      colSpan: colSpan,\n      label: {\n        text: _message.default.format(label)\n      },\n      validationRules: [{\n        type: \"required\"\n      }],\n      editorOptions: {\n        width: \"100%\",\n        calendarOptions: {\n          firstDayOfWeek: firstDayOfWeek\n        },\n        onValueChanged: callback\n      }\n    };\n  },\n  _createDateBoxItems: function (dataExprs, schedulerInst, allowTimeZoneEditing) {\n    var _this2 = this;\n\n    var colSpan = allowTimeZoneEditing ? 2 : 1;\n    var firstDayOfWeek = schedulerInst.option(\"firstDayOfWeek\");\n    return [this._createDateBoxEditor(dataExprs.startDateExpr, colSpan, firstDayOfWeek, \"dxScheduler-editorLabelStartDate\", function (args) {\n      _this2._dateBoxValueChanged(args, dataExprs.endDateExpr, function (endValue, startValue) {\n        return endValue < startValue;\n      });\n    }), this._createTimezoneEditor(dataExprs.startDateTimeZoneExpr, dataExprs.endDateTimeZoneExpr, 1, colSpan, true, allowTimeZoneEditing), this._createDateBoxEditor(dataExprs.endDateExpr, colSpan, firstDayOfWeek, \"dxScheduler-editorLabelEndDate\", function (args) {\n      _this2._dateBoxValueChanged(args, dataExprs.startDateExpr, function (startValue, endValue) {\n        return endValue < startValue;\n      });\n    }), this._createTimezoneEditor(dataExprs.endDateTimeZoneExpr, dataExprs.startDateTimeZoneExpr, 3, colSpan, false, allowTimeZoneEditing)];\n  },\n  _createMainItems: function (dataExprs, schedulerInst, triggerResize, changeSize, allowTimeZoneEditing) {\n    var _this3 = this;\n\n    return [{\n      dataField: dataExprs.textExpr,\n      editorType: \"dxTextBox\",\n      colSpan: 2,\n      label: {\n        text: _message.default.format(\"dxScheduler-editorLabelTitle\")\n      }\n    }, {\n      itemType: \"group\",\n      colSpan: 2,\n      colCountByScreen: {\n        lg: 2,\n        xs: 1\n      },\n      items: this._createDateBoxItems(dataExprs, schedulerInst, allowTimeZoneEditing)\n    }, {\n      itemType: \"group\",\n      colCountByScreen: {\n        lg: 3,\n        xs: 3\n      },\n      colSpan: 2,\n      items: [{\n        dataField: dataExprs.allDayExpr,\n        cssClass: \"dx-appointment-form-switch\",\n        editorType: \"dxSwitch\",\n        label: {\n          text: _message.default.format(\"dxScheduler-allDay\"),\n          location: \"right\"\n        },\n        editorOptions: {\n          onValueChanged: function (args) {\n            var value = args.value;\n\n            var startDateEditor = _this3._appointmentForm.getEditor(dataExprs.startDateExpr);\n\n            var endDateEditor = _this3._appointmentForm.getEditor(dataExprs.endDateExpr);\n\n            var startDate = _date_serialization.default.deserializeDate(startDateEditor.option(\"value\"));\n\n            if (!_this3._appointmentForm._lockDateShiftFlag && startDate) {\n              if (value) {\n                var allDayStartDate = _this3._getAllDayStartDate(startDate);\n\n                startDateEditor.option(\"value\", allDayStartDate);\n                endDateEditor.option(\"value\", _this3._getAllDayEndDate(allDayStartDate));\n              } else {\n                var startDateWithStartHour = _this3._getStartDateWithStartHour(startDate, schedulerInst.option(\"startDayHour\"));\n\n                var endDate = schedulerInst._workSpace.calculateEndDate(startDateWithStartHour);\n\n                startDateEditor.option(\"value\", startDateWithStartHour);\n                endDateEditor.option(\"value\", endDate);\n              }\n            }\n\n            startDateEditor.option(\"type\", value ? \"date\" : \"datetime\");\n            endDateEditor.option(\"type\", value ? \"date\" : \"datetime\");\n          }\n        }\n      }, {\n        editorType: \"dxSwitch\",\n        dataField: \"repeat\",\n        cssClass: \"dx-appointment-form-switch\",\n        name: \"visibilityChanged\",\n        label: {\n          text: _message.default.format(\"dxScheduler-editorLabelRecurrence\"),\n          location: \"right\"\n        },\n        editorOptions: {\n          onValueChanged: function (args) {\n            var form = _this3._appointmentForm;\n            var colSpan = args.value ? 1 : 2;\n            form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Main, \"colSpan\", colSpan);\n            form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \"colSpan\", colSpan);\n\n            _this3._updateRecurrenceItemVisibility(dataExprs.recurrenceRuleExpr, args.value, form);\n\n            changeSize(args.value);\n            triggerResize();\n          }\n        }\n      }]\n    }, {\n      itemType: \"empty\",\n      colSpan: 2\n    }, {\n      dataField: dataExprs.descriptionExpr,\n      editorType: \"dxTextArea\",\n      colSpan: 2,\n      label: {\n        text: _message.default.format(\"dxScheduler-editorLabelDescription\")\n      }\n    }, {\n      itemType: \"empty\",\n      colSpan: 2\n    }];\n  },\n  _updateRecurrenceItemVisibility: function (recurrenceRuleExpr, value, form) {\n    var _form$getEditor;\n\n    form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \"visible\", value);\n    !value && form.updateData(recurrenceRuleExpr, \"\");\n    null === (_form$getEditor = form.getEditor(recurrenceRuleExpr)) || void 0 === _form$getEditor ? void 0 : _form$getEditor.changeValueByVisibility(value);\n  },\n  prepareAppointmentFormEditors: function (dataExprs, schedulerInst, triggerResize, changeSize, appointmentData, allowTimeZoneEditing, readOnly) {\n    var recurrenceEditorVisibility = !!this.getRecurrenceRule(appointmentData, dataExprs);\n    changeSize(recurrenceEditorVisibility);\n    this._editors = [{\n      itemType: \"group\",\n      name: APPOINTMENT_FORM_GROUP_NAMES.Main,\n      colCountByScreen: {\n        lg: 2,\n        xs: 1\n      },\n      colSpan: recurrenceEditorVisibility ? 1 : 2,\n      items: this._createMainItems(dataExprs, schedulerInst, triggerResize, changeSize, allowTimeZoneEditing)\n    }, {\n      itemType: \"group\",\n      name: APPOINTMENT_FORM_GROUP_NAMES.Recurrence,\n      visible: recurrenceEditorVisibility,\n      colSpan: recurrenceEditorVisibility ? 1 : 2,\n      items: this._createRecurrenceEditor(dataExprs, schedulerInst, readOnly)\n    }];\n    return this._editors;\n  },\n  _createRecurrenceEditor: function (dataExprs, schedulerInst, readOnly) {\n    return [{\n      dataField: dataExprs.recurrenceRuleExpr,\n      editorType: \"dxRecurrenceEditor\",\n      editorOptions: {\n        readOnly: readOnly,\n        firstDayOfWeek: schedulerInst.option(\"firstDayOfWeek\")\n      },\n      label: {\n        text: \" \",\n        visible: false\n      }\n    }];\n  },\n  getRecurrenceRule: function (data, dataExprs) {\n    return data[dataExprs.recurrenceRuleExpr];\n  },\n  concatResources: function (resources) {\n    this._editors[0].items = this._editors[0].items.concat(resources);\n  },\n  setEditorsType: function (form, startDateExpr, endDateExpr, allDay) {\n    var startDateItemPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.Main, \".\").concat(startDateExpr);\n    var endDateItemPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \".\").concat(endDateExpr);\n    var startDateFormItem = form.itemOption(startDateItemPath);\n    var endDateFormItem = form.itemOption(endDateItemPath);\n\n    if (startDateFormItem && endDateFormItem) {\n      var startDateEditorOptions = startDateFormItem.editorOptions;\n      var endDateEditorOptions = endDateFormItem.editorOptions;\n      startDateEditorOptions.type = endDateEditorOptions.type = allDay ? \"date\" : \"datetime\";\n      form.itemOption(startDateItemPath, \"editorOptions\", startDateEditorOptions);\n      form.itemOption(endDateItemPath, \"editorOptions\", endDateEditorOptions);\n    }\n  },\n  updateTimeZoneEditorDataSource: function (date, expression) {\n    var timeZoneDataSource = new _data_source.default({\n      store: _utils.default.getDisplayedTimeZones(date),\n      paginate: true,\n      pageSize: 10\n    });\n    var options = {\n      dataSource: timeZoneDataSource\n    };\n    this.setEditorOptions(expression, \"Main\", options);\n  },\n  updateRecurrenceEditorStartDate: function (date, expression) {\n    var options = {\n      startDate: date\n    };\n    this.setEditorOptions(expression, \"Recurrence\", options);\n  },\n  setEditorOptions: function (name, groupName, options) {\n    var editorPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.groupName, \".\").concat(name);\n\n    var editor = this._appointmentForm.itemOption(editorPath);\n\n    editor && this._appointmentForm.itemOption(editorPath, \"editorOptions\", (0, _extend.extend)({}, editor.editorOptions, options));\n  },\n  updateFormData: function (appointmentForm, formData, dataExprs) {\n    appointmentForm._lockDateShiftFlag = true;\n    var startDate = new Date(formData[dataExprs.startDateExpr]);\n    var endDate = new Date(formData[dataExprs.endDateExpr]);\n    this.updateTimeZoneEditorDataSource(startDate, dataExprs.startDateTimeZoneExpr);\n    this.updateTimeZoneEditorDataSource(endDate, dataExprs.endDateTimeZoneExpr);\n    this.updateRecurrenceEditorStartDate(startDate, dataExprs.recurrenceRuleExpr);\n    appointmentForm.option(\"formData\", formData);\n    appointmentForm._lockDateShiftFlag = false;\n  }\n};\nexports.AppointmentForm = SchedulerAppointmentForm;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/ui/scheduler/ui.scheduler.appointment_form.js"],"names":["exports","AppointmentForm","APPOINTMENT_FORM_GROUP_NAMES","_form","_interopRequireDefault","require","_date_serialization","_message","_devices","_data_source","_utils","_extend","obj","__esModule","SCREEN_SIZE_OF_SINGLE_COLUMN","Main","Recurrence","SchedulerAppointmentForm","_appointmentForm","_lockDateShiftFlag","_validateAppointmentFormDate","editor","value","previousValue","isCurrentDateCorrect","isPreviousDateCorrect","option","_getAllDayStartDate","startDate","Date","setHours","_getAllDayEndDate","setDate","getDate","_getStartDateWithStartHour","startDayHour","create","componentCreator","$container","isReadOnly","formData","default","items","_editors","readOnly","showValidationSummary","scrollingEnabled","colCount","colCountByScreen","lg","xs","showColonAfterLabel","labelLocation","screenByWidth","width","current","deviceType","_dateBoxValueChanged","args","dateExpr","isNeedCorrect","component","deserializeDate","dateEditor","getEditor","dateValue","duration","getTime","_createTimezoneEditor","timeZoneExpr","secondTimeZoneExpr","visibleIndex","colSpan","isMainTimeZone","_this","isShow","arguments","length","noTzTitle","format","dataField","editorType","label","text","editorOptions","displayExpr","valueExpr","placeholder","searchEnabled","onValueChanged","form","secondTimezoneEditor","visible","_createDateBoxEditor","dataExpr","firstDayOfWeek","callback","validationRules","type","calendarOptions","_createDateBoxItems","dataExprs","schedulerInst","allowTimeZoneEditing","_this2","startDateExpr","endDateExpr","endValue","startValue","startDateTimeZoneExpr","endDateTimeZoneExpr","_createMainItems","triggerResize","changeSize","_this3","textExpr","itemType","allDayExpr","cssClass","location","startDateEditor","endDateEditor","allDayStartDate","startDateWithStartHour","endDate","_workSpace","calculateEndDate","name","itemOption","_updateRecurrenceItemVisibility","recurrenceRuleExpr","descriptionExpr","_form$getEditor","updateData","changeValueByVisibility","prepareAppointmentFormEditors","appointmentData","recurrenceEditorVisibility","getRecurrenceRule","_createRecurrenceEditor","data","concatResources","resources","concat","setEditorsType","allDay","startDateItemPath","endDateItemPath","startDateFormItem","endDateFormItem","startDateEditorOptions","endDateEditorOptions","updateTimeZoneEditorDataSource","date","expression","timeZoneDataSource","store","getDisplayedTimeZones","paginate","pageSize","options","dataSource","setEditorOptions","updateRecurrenceEditorStartDate","groupName","editorPath","extend","updateFormData","appointmentForm"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment_form.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.AppointmentForm = exports.APPOINTMENT_FORM_GROUP_NAMES = void 0;\r\nvar _form = _interopRequireDefault(require(\"../form\"));\r\nvar _date_serialization = _interopRequireDefault(require(\"../../core/utils/date_serialization\"));\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _devices = _interopRequireDefault(require(\"../../core/devices\"));\r\nvar _data_source = _interopRequireDefault(require(\"../../data/data_source\"));\r\nvar _utils = _interopRequireDefault(require(\"./timezones/utils.timezones_data\"));\r\nvar _extend = require(\"../../core/utils/extend\");\r\nrequire(\"./ui.scheduler.recurrence_editor\");\r\nrequire(\"../text_area\");\r\nrequire(\"../tag_box\");\r\nrequire(\"../switch\");\r\nrequire(\"../select_box\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar SCREEN_SIZE_OF_SINGLE_COLUMN = 600;\r\nvar APPOINTMENT_FORM_GROUP_NAMES = {\r\n    Main: \"mainGroup\",\r\n    Recurrence: \"recurrenceGroup\"\r\n};\r\nexports.APPOINTMENT_FORM_GROUP_NAMES = APPOINTMENT_FORM_GROUP_NAMES;\r\nvar SchedulerAppointmentForm = {\r\n    _appointmentForm: {},\r\n    _lockDateShiftFlag: false,\r\n    _validateAppointmentFormDate: function(editor, value, previousValue) {\r\n        var isCurrentDateCorrect = null === value || !!value;\r\n        var isPreviousDateCorrect = null === previousValue || !!previousValue;\r\n        if (!isCurrentDateCorrect && isPreviousDateCorrect) {\r\n            editor.option(\"value\", previousValue)\r\n        }\r\n    },\r\n    _getAllDayStartDate: function(startDate) {\r\n        return new Date(new Date(startDate).setHours(0, 0, 0, 0))\r\n    },\r\n    _getAllDayEndDate: function(startDate) {\r\n        return new Date(new Date(startDate).setDate(startDate.getDate() + 1))\r\n    },\r\n    _getStartDateWithStartHour: function(startDate, startDayHour) {\r\n        return new Date(new Date(startDate).setHours(startDayHour))\r\n    },\r\n    create: function(componentCreator, $container, isReadOnly, formData) {\r\n        this._appointmentForm = componentCreator($container, _form.default, {\r\n            items: this._editors,\r\n            readOnly: isReadOnly,\r\n            showValidationSummary: true,\r\n            scrollingEnabled: true,\r\n            colCount: \"auto\",\r\n            colCountByScreen: {\r\n                lg: 2,\r\n                xs: 1\r\n            },\r\n            formData: formData,\r\n            showColonAfterLabel: false,\r\n            labelLocation: \"top\",\r\n            screenByWidth: function(width) {\r\n                return width < SCREEN_SIZE_OF_SINGLE_COLUMN || \"desktop\" !== _devices.default.current().deviceType ? \"xs\" : \"lg\"\r\n            }\r\n        });\r\n        return this._appointmentForm\r\n    },\r\n    _dateBoxValueChanged: function(args, dateExpr, isNeedCorrect) {\r\n        this._validateAppointmentFormDate(args.component, args.value, args.previousValue);\r\n        var value = _date_serialization.default.deserializeDate(args.value);\r\n        var previousValue = _date_serialization.default.deserializeDate(args.previousValue);\r\n        var dateEditor = this._appointmentForm.getEditor(dateExpr);\r\n        var dateValue = _date_serialization.default.deserializeDate(dateEditor.option(\"value\"));\r\n        if (!this._appointmentForm._lockDateShiftFlag && dateValue && value && isNeedCorrect(dateValue, value)) {\r\n            var duration = previousValue ? dateValue.getTime() - previousValue.getTime() : 0;\r\n            dateEditor.option(\"value\", new Date(value.getTime() + duration))\r\n        }\r\n    },\r\n    _createTimezoneEditor: function(timeZoneExpr, secondTimeZoneExpr, visibleIndex, colSpan, isMainTimeZone) {\r\n        var _this = this;\r\n        var isShow = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : false;\r\n        var noTzTitle = _message.default.format(\"dxScheduler-noTimezoneTitle\");\r\n        return {\r\n            dataField: timeZoneExpr,\r\n            editorType: \"dxSelectBox\",\r\n            visibleIndex: visibleIndex,\r\n            colSpan: colSpan,\r\n            label: {\r\n                text: \" \"\r\n            },\r\n            editorOptions: {\r\n                displayExpr: \"title\",\r\n                valueExpr: \"id\",\r\n                placeholder: noTzTitle,\r\n                searchEnabled: true,\r\n                onValueChanged: function(args) {\r\n                    var form = _this._appointmentForm;\r\n                    var secondTimezoneEditor = form.getEditor(secondTimeZoneExpr);\r\n                    if (isMainTimeZone) {\r\n                        secondTimezoneEditor.option(\"value\", args.value)\r\n                    }\r\n                }\r\n            },\r\n            visible: isShow\r\n        }\r\n    },\r\n    _createDateBoxEditor: function(dataExpr, colSpan, firstDayOfWeek, label, callback) {\r\n        return {\r\n            dataField: dataExpr,\r\n            editorType: \"dxDateBox\",\r\n            colSpan: colSpan,\r\n            label: {\r\n                text: _message.default.format(label)\r\n            },\r\n            validationRules: [{\r\n                type: \"required\"\r\n            }],\r\n            editorOptions: {\r\n                width: \"100%\",\r\n                calendarOptions: {\r\n                    firstDayOfWeek: firstDayOfWeek\r\n                },\r\n                onValueChanged: callback\r\n            }\r\n        }\r\n    },\r\n    _createDateBoxItems: function(dataExprs, schedulerInst, allowTimeZoneEditing) {\r\n        var _this2 = this;\r\n        var colSpan = allowTimeZoneEditing ? 2 : 1;\r\n        var firstDayOfWeek = schedulerInst.option(\"firstDayOfWeek\");\r\n        return [this._createDateBoxEditor(dataExprs.startDateExpr, colSpan, firstDayOfWeek, \"dxScheduler-editorLabelStartDate\", function(args) {\r\n            _this2._dateBoxValueChanged(args, dataExprs.endDateExpr, function(endValue, startValue) {\r\n                return endValue < startValue\r\n            })\r\n        }), this._createTimezoneEditor(dataExprs.startDateTimeZoneExpr, dataExprs.endDateTimeZoneExpr, 1, colSpan, true, allowTimeZoneEditing), this._createDateBoxEditor(dataExprs.endDateExpr, colSpan, firstDayOfWeek, \"dxScheduler-editorLabelEndDate\", function(args) {\r\n            _this2._dateBoxValueChanged(args, dataExprs.startDateExpr, function(startValue, endValue) {\r\n                return endValue < startValue\r\n            })\r\n        }), this._createTimezoneEditor(dataExprs.endDateTimeZoneExpr, dataExprs.startDateTimeZoneExpr, 3, colSpan, false, allowTimeZoneEditing)]\r\n    },\r\n    _createMainItems: function(dataExprs, schedulerInst, triggerResize, changeSize, allowTimeZoneEditing) {\r\n        var _this3 = this;\r\n        return [{\r\n            dataField: dataExprs.textExpr,\r\n            editorType: \"dxTextBox\",\r\n            colSpan: 2,\r\n            label: {\r\n                text: _message.default.format(\"dxScheduler-editorLabelTitle\")\r\n            }\r\n        }, {\r\n            itemType: \"group\",\r\n            colSpan: 2,\r\n            colCountByScreen: {\r\n                lg: 2,\r\n                xs: 1\r\n            },\r\n            items: this._createDateBoxItems(dataExprs, schedulerInst, allowTimeZoneEditing)\r\n        }, {\r\n            itemType: \"group\",\r\n            colCountByScreen: {\r\n                lg: 3,\r\n                xs: 3\r\n            },\r\n            colSpan: 2,\r\n            items: [{\r\n                dataField: dataExprs.allDayExpr,\r\n                cssClass: \"dx-appointment-form-switch\",\r\n                editorType: \"dxSwitch\",\r\n                label: {\r\n                    text: _message.default.format(\"dxScheduler-allDay\"),\r\n                    location: \"right\"\r\n                },\r\n                editorOptions: {\r\n                    onValueChanged: function(args) {\r\n                        var value = args.value;\r\n                        var startDateEditor = _this3._appointmentForm.getEditor(dataExprs.startDateExpr);\r\n                        var endDateEditor = _this3._appointmentForm.getEditor(dataExprs.endDateExpr);\r\n                        var startDate = _date_serialization.default.deserializeDate(startDateEditor.option(\"value\"));\r\n                        if (!_this3._appointmentForm._lockDateShiftFlag && startDate) {\r\n                            if (value) {\r\n                                var allDayStartDate = _this3._getAllDayStartDate(startDate);\r\n                                startDateEditor.option(\"value\", allDayStartDate);\r\n                                endDateEditor.option(\"value\", _this3._getAllDayEndDate(allDayStartDate))\r\n                            } else {\r\n                                var startDateWithStartHour = _this3._getStartDateWithStartHour(startDate, schedulerInst.option(\"startDayHour\"));\r\n                                var endDate = schedulerInst._workSpace.calculateEndDate(startDateWithStartHour);\r\n                                startDateEditor.option(\"value\", startDateWithStartHour);\r\n                                endDateEditor.option(\"value\", endDate)\r\n                            }\r\n                        }\r\n                        startDateEditor.option(\"type\", value ? \"date\" : \"datetime\");\r\n                        endDateEditor.option(\"type\", value ? \"date\" : \"datetime\")\r\n                    }\r\n                }\r\n            }, {\r\n                editorType: \"dxSwitch\",\r\n                dataField: \"repeat\",\r\n                cssClass: \"dx-appointment-form-switch\",\r\n                name: \"visibilityChanged\",\r\n                label: {\r\n                    text: _message.default.format(\"dxScheduler-editorLabelRecurrence\"),\r\n                    location: \"right\"\r\n                },\r\n                editorOptions: {\r\n                    onValueChanged: function(args) {\r\n                        var form = _this3._appointmentForm;\r\n                        var colSpan = args.value ? 1 : 2;\r\n                        form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Main, \"colSpan\", colSpan);\r\n                        form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \"colSpan\", colSpan);\r\n                        _this3._updateRecurrenceItemVisibility(dataExprs.recurrenceRuleExpr, args.value, form);\r\n                        changeSize(args.value);\r\n                        triggerResize()\r\n                    }\r\n                }\r\n            }]\r\n        }, {\r\n            itemType: \"empty\",\r\n            colSpan: 2\r\n        }, {\r\n            dataField: dataExprs.descriptionExpr,\r\n            editorType: \"dxTextArea\",\r\n            colSpan: 2,\r\n            label: {\r\n                text: _message.default.format(\"dxScheduler-editorLabelDescription\")\r\n            }\r\n        }, {\r\n            itemType: \"empty\",\r\n            colSpan: 2\r\n        }]\r\n    },\r\n    _updateRecurrenceItemVisibility: function(recurrenceRuleExpr, value, form) {\r\n        var _form$getEditor;\r\n        form.itemOption(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \"visible\", value);\r\n        !value && form.updateData(recurrenceRuleExpr, \"\");\r\n        null === (_form$getEditor = form.getEditor(recurrenceRuleExpr)) || void 0 === _form$getEditor ? void 0 : _form$getEditor.changeValueByVisibility(value)\r\n    },\r\n    prepareAppointmentFormEditors: function(dataExprs, schedulerInst, triggerResize, changeSize, appointmentData, allowTimeZoneEditing, readOnly) {\r\n        var recurrenceEditorVisibility = !!this.getRecurrenceRule(appointmentData, dataExprs);\r\n        changeSize(recurrenceEditorVisibility);\r\n        this._editors = [{\r\n            itemType: \"group\",\r\n            name: APPOINTMENT_FORM_GROUP_NAMES.Main,\r\n            colCountByScreen: {\r\n                lg: 2,\r\n                xs: 1\r\n            },\r\n            colSpan: recurrenceEditorVisibility ? 1 : 2,\r\n            items: this._createMainItems(dataExprs, schedulerInst, triggerResize, changeSize, allowTimeZoneEditing)\r\n        }, {\r\n            itemType: \"group\",\r\n            name: APPOINTMENT_FORM_GROUP_NAMES.Recurrence,\r\n            visible: recurrenceEditorVisibility,\r\n            colSpan: recurrenceEditorVisibility ? 1 : 2,\r\n            items: this._createRecurrenceEditor(dataExprs, schedulerInst, readOnly)\r\n        }];\r\n        return this._editors\r\n    },\r\n    _createRecurrenceEditor: function(dataExprs, schedulerInst, readOnly) {\r\n        return [{\r\n            dataField: dataExprs.recurrenceRuleExpr,\r\n            editorType: \"dxRecurrenceEditor\",\r\n            editorOptions: {\r\n                readOnly: readOnly,\r\n                firstDayOfWeek: schedulerInst.option(\"firstDayOfWeek\")\r\n            },\r\n            label: {\r\n                text: \" \",\r\n                visible: false\r\n            }\r\n        }]\r\n    },\r\n    getRecurrenceRule: function(data, dataExprs) {\r\n        return data[dataExprs.recurrenceRuleExpr]\r\n    },\r\n    concatResources: function(resources) {\r\n        this._editors[0].items = this._editors[0].items.concat(resources)\r\n    },\r\n    setEditorsType: function(form, startDateExpr, endDateExpr, allDay) {\r\n        var startDateItemPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.Main, \".\").concat(startDateExpr);\r\n        var endDateItemPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.Recurrence, \".\").concat(endDateExpr);\r\n        var startDateFormItem = form.itemOption(startDateItemPath);\r\n        var endDateFormItem = form.itemOption(endDateItemPath);\r\n        if (startDateFormItem && endDateFormItem) {\r\n            var startDateEditorOptions = startDateFormItem.editorOptions;\r\n            var endDateEditorOptions = endDateFormItem.editorOptions;\r\n            startDateEditorOptions.type = endDateEditorOptions.type = allDay ? \"date\" : \"datetime\";\r\n            form.itemOption(startDateItemPath, \"editorOptions\", startDateEditorOptions);\r\n            form.itemOption(endDateItemPath, \"editorOptions\", endDateEditorOptions)\r\n        }\r\n    },\r\n    updateTimeZoneEditorDataSource: function(date, expression) {\r\n        var timeZoneDataSource = new _data_source.default({\r\n            store: _utils.default.getDisplayedTimeZones(date),\r\n            paginate: true,\r\n            pageSize: 10\r\n        });\r\n        var options = {\r\n            dataSource: timeZoneDataSource\r\n        };\r\n        this.setEditorOptions(expression, \"Main\", options)\r\n    },\r\n    updateRecurrenceEditorStartDate: function(date, expression) {\r\n        var options = {\r\n            startDate: date\r\n        };\r\n        this.setEditorOptions(expression, \"Recurrence\", options)\r\n    },\r\n    setEditorOptions: function(name, groupName, options) {\r\n        var editorPath = \"\".concat(APPOINTMENT_FORM_GROUP_NAMES.groupName, \".\").concat(name);\r\n        var editor = this._appointmentForm.itemOption(editorPath);\r\n        editor && this._appointmentForm.itemOption(editorPath, \"editorOptions\", (0, _extend.extend)({}, editor.editorOptions, options))\r\n    },\r\n    updateFormData: function(appointmentForm, formData, dataExprs) {\r\n        appointmentForm._lockDateShiftFlag = true;\r\n        var startDate = new Date(formData[dataExprs.startDateExpr]);\r\n        var endDate = new Date(formData[dataExprs.endDateExpr]);\r\n        this.updateTimeZoneEditorDataSource(startDate, dataExprs.startDateTimeZoneExpr);\r\n        this.updateTimeZoneEditorDataSource(endDate, dataExprs.endDateTimeZoneExpr);\r\n        this.updateRecurrenceEditorStartDate(startDate, dataExprs.recurrenceRuleExpr);\r\n        appointmentForm.option(\"formData\", formData);\r\n        appointmentForm._lockDateShiftFlag = false\r\n    }\r\n};\r\nexports.AppointmentForm = SchedulerAppointmentForm;\r\n"]},"metadata":{},"sourceType":"script"}