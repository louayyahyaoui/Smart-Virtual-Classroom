{"ast":null,"code":"/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.SelectionFilterCreator = void 0;\n\nvar _common = require(\"./common\");\n\nvar _type = require(\"./type\");\n\nvar SelectionFilterCreator = function (selectedItemKeys, isSelectAll) {\n  this.getLocalFilter = function (keyGetter, equalKeys, equalByReference, keyExpr) {\n    equalKeys = void 0 === equalKeys ? _common.equalByValue : equalKeys;\n    return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr);\n  };\n\n  this.getExpr = function (keyExpr) {\n    if (!keyExpr) {\n      return;\n    }\n\n    var filterExpr;\n    selectedItemKeys.forEach(function (key, index) {\n      filterExpr = filterExpr || [];\n      var filterExprPart;\n\n      if (index > 0) {\n        filterExpr.push(isSelectAll ? \"and\" : \"or\");\n      }\n\n      if ((0, _type.isString)(keyExpr)) {\n        filterExprPart = getFilterForPlainKey(keyExpr, key);\n      } else {\n        filterExprPart = getFilterForCompositeKey(keyExpr, key);\n      }\n\n      filterExpr.push(filterExprPart);\n    });\n\n    if (filterExpr && 1 === filterExpr.length) {\n      filterExpr = filterExpr[0];\n    }\n\n    return filterExpr;\n  };\n\n  this.getCombinedFilter = function (keyExpr, dataSourceFilter) {\n    var filterExpr = this.getExpr(keyExpr);\n    var combinedFilter = filterExpr;\n\n    if (isSelectAll && dataSourceFilter) {\n      if (filterExpr) {\n        combinedFilter = [];\n        combinedFilter.push(filterExpr);\n        combinedFilter.push(dataSourceFilter);\n      } else {\n        combinedFilter = dataSourceFilter;\n      }\n    }\n\n    return combinedFilter;\n  };\n\n  var selectedItemKeyHashesMap;\n\n  var getSelectedItemKeyHashesMap = function (selectedItemKeys) {\n    if (!selectedItemKeyHashesMap) {\n      selectedItemKeyHashesMap = {};\n\n      for (var i = 0; i < selectedItemKeys.length; i++) {\n        selectedItemKeyHashesMap[(0, _common.getKeyHash)(selectedItemKeys[i])] = true;\n      }\n    }\n\n    return selectedItemKeyHashesMap;\n  };\n\n  var normalizeKeys = function (keys, keyOf, keyExpr) {\n    return Array.isArray(keyExpr) ? keys.map(function (key) {\n      return keyOf(key);\n    }) : keys;\n  };\n\n  function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\n    var key = keyOf(item);\n    var keyHash;\n    var i;\n\n    if (!equalByReference) {\n      keyHash = (0, _common.getKeyHash)(key);\n\n      if (!(0, _type.isObject)(keyHash)) {\n        var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\n\n        if (selectedKeyHashesMap[keyHash]) {\n          return !isSelectAll;\n        }\n\n        return !!isSelectAll;\n      }\n    }\n\n    for (i = 0; i < selectedItemKeys.length; i++) {\n      if (equalKeys(selectedItemKeys[i], key)) {\n        return !isSelectAll;\n      }\n    }\n\n    return !!isSelectAll;\n  }\n\n  function getFilterForPlainKey(keyExpr, keyValue) {\n    if (void 0 === keyValue) {\n      return;\n    }\n\n    return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue];\n  }\n\n  function getFilterForCompositeKey(keyExpr, itemKeyValue) {\n    var filterExpr = [];\n\n    for (var i = 0, length = keyExpr.length; i < length; i++) {\n      var currentKeyExpr = keyExpr[i];\n      var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\n      var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\n\n      if (!filterExprPart) {\n        break;\n      }\n\n      if (i > 0) {\n        filterExpr.push(isSelectAll ? \"or\" : \"and\");\n      }\n\n      filterExpr.push(filterExprPart);\n    }\n\n    return filterExpr;\n  }\n};\n\nexports.SelectionFilterCreator = SelectionFilterCreator;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/core/utils/selection_filter.js"],"names":["exports","SelectionFilterCreator","_common","require","_type","selectedItemKeys","isSelectAll","getLocalFilter","keyGetter","equalKeys","equalByReference","keyExpr","equalByValue","functionFilter","bind","getExpr","filterExpr","forEach","key","index","filterExprPart","push","isString","getFilterForPlainKey","getFilterForCompositeKey","length","getCombinedFilter","dataSourceFilter","combinedFilter","selectedItemKeyHashesMap","getSelectedItemKeyHashesMap","i","getKeyHash","normalizeKeys","keys","keyOf","Array","isArray","map","item","keyHash","isObject","selectedKeyHashesMap","keyValue","itemKeyValue","currentKeyExpr","currentKeyValue"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.SelectionFilterCreator = void 0;\r\nvar _common = require(\"./common\");\r\nvar _type = require(\"./type\");\r\nvar SelectionFilterCreator = function(selectedItemKeys, isSelectAll) {\r\n    this.getLocalFilter = function(keyGetter, equalKeys, equalByReference, keyExpr) {\r\n        equalKeys = void 0 === equalKeys ? _common.equalByValue : equalKeys;\r\n        return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr)\r\n    };\r\n    this.getExpr = function(keyExpr) {\r\n        if (!keyExpr) {\r\n            return\r\n        }\r\n        var filterExpr;\r\n        selectedItemKeys.forEach(function(key, index) {\r\n            filterExpr = filterExpr || [];\r\n            var filterExprPart;\r\n            if (index > 0) {\r\n                filterExpr.push(isSelectAll ? \"and\" : \"or\")\r\n            }\r\n            if ((0, _type.isString)(keyExpr)) {\r\n                filterExprPart = getFilterForPlainKey(keyExpr, key)\r\n            } else {\r\n                filterExprPart = getFilterForCompositeKey(keyExpr, key)\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        });\r\n        if (filterExpr && 1 === filterExpr.length) {\r\n            filterExpr = filterExpr[0]\r\n        }\r\n        return filterExpr\r\n    };\r\n    this.getCombinedFilter = function(keyExpr, dataSourceFilter) {\r\n        var filterExpr = this.getExpr(keyExpr);\r\n        var combinedFilter = filterExpr;\r\n        if (isSelectAll && dataSourceFilter) {\r\n            if (filterExpr) {\r\n                combinedFilter = [];\r\n                combinedFilter.push(filterExpr);\r\n                combinedFilter.push(dataSourceFilter)\r\n            } else {\r\n                combinedFilter = dataSourceFilter\r\n            }\r\n        }\r\n        return combinedFilter\r\n    };\r\n    var selectedItemKeyHashesMap;\r\n    var getSelectedItemKeyHashesMap = function(selectedItemKeys) {\r\n        if (!selectedItemKeyHashesMap) {\r\n            selectedItemKeyHashesMap = {};\r\n            for (var i = 0; i < selectedItemKeys.length; i++) {\r\n                selectedItemKeyHashesMap[(0, _common.getKeyHash)(selectedItemKeys[i])] = true\r\n            }\r\n        }\r\n        return selectedItemKeyHashesMap\r\n    };\r\n    var normalizeKeys = function(keys, keyOf, keyExpr) {\r\n        return Array.isArray(keyExpr) ? keys.map(function(key) {\r\n            return keyOf(key)\r\n        }) : keys\r\n    };\r\n\r\n    function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\r\n        var key = keyOf(item);\r\n        var keyHash;\r\n        var i;\r\n        if (!equalByReference) {\r\n            keyHash = (0, _common.getKeyHash)(key);\r\n            if (!(0, _type.isObject)(keyHash)) {\r\n                var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\r\n                if (selectedKeyHashesMap[keyHash]) {\r\n                    return !isSelectAll\r\n                }\r\n                return !!isSelectAll\r\n            }\r\n        }\r\n        for (i = 0; i < selectedItemKeys.length; i++) {\r\n            if (equalKeys(selectedItemKeys[i], key)) {\r\n                return !isSelectAll\r\n            }\r\n        }\r\n        return !!isSelectAll\r\n    }\r\n\r\n    function getFilterForPlainKey(keyExpr, keyValue) {\r\n        if (void 0 === keyValue) {\r\n            return\r\n        }\r\n        return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue]\r\n    }\r\n\r\n    function getFilterForCompositeKey(keyExpr, itemKeyValue) {\r\n        var filterExpr = [];\r\n        for (var i = 0, length = keyExpr.length; i < length; i++) {\r\n            var currentKeyExpr = keyExpr[i];\r\n            var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\r\n            var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\r\n            if (!filterExprPart) {\r\n                break\r\n            }\r\n            if (i > 0) {\r\n                filterExpr.push(isSelectAll ? \"or\" : \"and\")\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        }\r\n        return filterExpr\r\n    }\r\n};\r\nexports.SelectionFilterCreator = SelectionFilterCreator;\r\n"]},"metadata":{},"sourceType":"script"}