{"ast":null,"code":"/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\n\nvar _common = require(\"../core/utils/common\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _array = require(\"../core/utils/array\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nvar _element = require(\"../core/element\");\n\nvar _errors = _interopRequireDefault(require(\"../core/errors\"));\n\nvar _dom_adapter = _interopRequireDefault(require(\"../core/dom_adapter\"));\n\nvar _utils = require(\"./widget/utils.ink_ripple\");\n\nvar _message = _interopRequireDefault(require(\"../localization/message\"));\n\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\n\nvar _ui = _interopRequireDefault(require(\"./drop_down_editor/ui.drop_down_list\"));\n\nvar _index = require(\"../events/utils/index\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\nvar SELECTBOX_CLASS = \"dx-selectbox\";\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\n\nvar SelectBox = _ui.default.inherit({\n  _supportedKeys: function () {\n    var that = this;\n    var parent = this.callBase();\n\n    var clearSelectBox = function (e) {\n      var isEditable = this._isEditable();\n\n      if (!isEditable) {\n        if (this.option(\"showClearButton\")) {\n          e.preventDefault();\n          this.reset();\n        }\n      } else {\n        if (this._valueSubstituted()) {\n          this._preventFiltering = true;\n        }\n      }\n\n      this._savedTextRemoveEvent = e;\n      this._preventSubstitution = true;\n    };\n\n    var searchIfNeeded = function () {\n      if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\n        that._searchHandler();\n      }\n    };\n\n    return (0, _extend.extend)({}, parent, {\n      tab: function () {\n        if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\n          this._resetCaretPosition(true);\n        }\n\n        parent.tab && parent.tab.apply(this, arguments);\n\n        this._cancelSearchIfNeed();\n      },\n      upArrow: function (e) {\n        if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      downArrow: function (e) {\n        if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      leftArrow: function () {\n        searchIfNeeded();\n        parent.leftArrow && parent.leftArrow.apply(this, arguments);\n      },\n      rightArrow: function () {\n        searchIfNeeded();\n        parent.rightArrow && parent.rightArrow.apply(this, arguments);\n      },\n      home: function () {\n        searchIfNeeded();\n        parent.home && parent.home.apply(this, arguments);\n      },\n      end: function () {\n        searchIfNeeded();\n        parent.end && parent.end.apply(this, arguments);\n      },\n      escape: function () {\n        var result = parent.escape && parent.escape.apply(this, arguments);\n\n        this._cancelEditing();\n\n        return null !== result && void 0 !== result ? result : true;\n      },\n      enter: function (e) {\n        var isOpened = this.option(\"opened\");\n\n        var inputText = this._input().val().trim();\n\n        var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\n\n        if (!inputText && (0, _type.isDefined)(this.option(\"value\")) && this.option(\"allowClearing\")) {\n          this._saveValueChangeEvent(e);\n\n          this.option({\n            selectedItem: null,\n            value: null\n          });\n          this.close();\n        } else {\n          if (this.option(\"acceptCustomValue\")) {\n            e.preventDefault();\n\n            if (isCustomText) {\n              if (isOpened) {\n                this._toggleOpenState();\n              }\n\n              this._valueChangeEventHandler(e);\n            }\n\n            return isOpened;\n          }\n\n          if (parent.enter && parent.enter.apply(this, arguments)) {\n            return isOpened;\n          }\n        }\n      },\n      space: function (e) {\n        var isOpened = this.option(\"opened\");\n        var isSearchEnabled = this.option(\"searchEnabled\");\n        var acceptCustomValue = this.option(\"acceptCustomValue\");\n\n        if (!isOpened || isSearchEnabled || acceptCustomValue) {\n          return;\n        }\n\n        e.preventDefault();\n\n        this._valueChangeEventHandler(e);\n\n        return true;\n      },\n      backspace: clearSelectBox,\n      del: clearSelectBox\n    });\n  },\n  _getDefaultOptions: function () {\n    return (0, _extend.extend)(this.callBase(), {\n      placeholder: _message.default.format(\"Select\"),\n      fieldTemplate: null,\n      valueChangeEvent: \"change\",\n      acceptCustomValue: false,\n      onCustomItemCreating: function (e) {\n        if (!(0, _type.isDefined)(e.customItem)) {\n          e.customItem = e.text;\n        }\n      },\n      showSelectionControls: false,\n      allowClearing: true,\n      tooltipEnabled: false,\n      openOnFieldClick: true,\n      showDropDownButton: true,\n      displayCustomValue: false,\n      useInkRipple: false,\n      useHiddenSubmitElement: true\n    });\n  },\n  _init: function () {\n    this.callBase();\n\n    this._initCustomItemCreatingAction();\n  },\n  _initMarkup: function () {\n    this.$element().addClass(SELECTBOX_CLASS);\n\n    this._renderTooltip();\n\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n    this.callBase();\n\n    this._$container.addClass(SELECTBOX_CONTAINER_CLASS);\n  },\n  _renderInkRipple: function () {\n    this._inkRipple = (0, _utils.render)();\n  },\n  _toggleActiveState: function ($element, value, e) {\n    this.callBase.apply(this, arguments);\n\n    if (!this._inkRipple || this._isEditable()) {\n      return;\n    }\n\n    var config = {\n      element: this._inputWrapper(),\n      event: e\n    };\n\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  },\n  _createPopup: function () {\n    this.callBase();\n\n    this._popup.$element().addClass(SELECTBOX_POPUP_CLASS);\n\n    this._popup.overlayContent().attr(\"tabindex\", -1);\n  },\n  _popupWrapperClass: function () {\n    return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS;\n  },\n  _cancelEditing: function () {\n    if (!this.option(\"searchEnabled\") && this._list) {\n      this._focusListElement(null);\n\n      this._updateField(this.option(\"selectedItem\"));\n    }\n  },\n  _renderOpenedState: function () {\n    this.callBase();\n\n    if (this.option(\"opened\")) {\n      this._scrollToSelectedItem();\n\n      this._focusSelectedElement();\n    }\n  },\n  _focusSelectedElement: function () {\n    var searchValue = this._searchValue();\n\n    if (!searchValue) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var index = (0, _array.inArray)(this.option(\"selectedItem\"), this.option(\"items\"));\n    var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\n\n    this._focusListElement(focusedElement);\n  },\n  _renderFocusedElement: function () {\n    if (!this._list) {\n      return;\n    }\n\n    var searchValue = this._searchValue();\n\n    if (!searchValue || this.option(\"acceptCustomValue\")) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\n\n    this._focusListElement(focusedElement);\n  },\n  _focusListElement: function (element) {\n    this._preventInputValueRender = true;\n\n    this._list.option(\"focusedElement\", (0, _element.getPublicElement)(element));\n\n    delete this._preventInputValueRender;\n  },\n  _scrollToSelectedItem: function () {\n    this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"));\n  },\n  _listContentReadyHandler: function () {\n    this.callBase();\n\n    var isPaginate = this._dataSource && this._dataSource.paginate();\n\n    if (isPaginate && this._needPopupRepaint()) {\n      return;\n    }\n\n    this._scrollToSelectedItem();\n  },\n  _renderValue: function () {\n    this._renderInputValue();\n\n    this._setSubmitValue();\n\n    return new _deferred.Deferred().resolve();\n  },\n  _renderInputValue: function () {\n    return this.callBase().always(function () {\n      this._renderInputValueAsync();\n    }.bind(this));\n  },\n  _renderInputValueAsync: function () {\n    this._renderTooltip();\n\n    this._renderInputValueImpl().always(function () {\n      this._refreshSelected();\n    }.bind(this));\n  },\n  _renderInputValueImpl: function () {\n    this._renderField();\n\n    return new _deferred.Deferred().resolve();\n  },\n  _setNextItem: function (step) {\n    var item = this._calcNextItem(step);\n\n    var value = this._valueGetter(item);\n\n    this._setValue(value);\n  },\n  _setNextValue: function (e) {\n    var dataSourceIsLoaded = this._dataSource.isLoaded() ? new _deferred.Deferred().resolve() : this._dataSource.load();\n    dataSourceIsLoaded.done(function () {\n      var selectedIndex = this._getSelectedIndex();\n\n      var hasPages = this._dataSource.pageSize();\n\n      var isLastPage = this._dataSource.isLastPage();\n\n      var isLastItem = selectedIndex === this._items().length - 1;\n\n      this._saveValueChangeEvent(e);\n\n      var step = \"downArrow\" === (0, _index.normalizeKeyName)(e) ? 1 : -1;\n\n      if (hasPages && !isLastPage && isLastItem && step > 0) {\n        if (!this._popup) {\n          this._createPopup();\n        }\n\n        if (!this._dataSource.isLoading()) {\n          this._list._loadNextPage().done(this._setNextItem.bind(this, step));\n        }\n      } else {\n        this._setNextItem(step);\n      }\n    }.bind(this));\n  },\n  _setSelectedItem: function (item) {\n    var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\n    this.callBase(isUnknownItem ? null : item);\n\n    if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\n      this._setListOption(\"selectedItem\", this.option(\"selectedItem\"));\n    }\n  },\n  _isCustomValueAllowed: function () {\n    return this.option(\"acceptCustomValue\") || this.callBase();\n  },\n  _displayValue: function (item) {\n    item = !(0, _type.isDefined)(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\n    return this.callBase(item);\n  },\n  _listConfig: function () {\n    var result = (0, _extend.extend)(this.callBase(), {\n      pageLoadMode: \"scrollBottom\",\n      onSelectionChanged: this._getSelectionChangeHandler(),\n      selectedItem: this.option(\"selectedItem\"),\n      onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\n    });\n\n    if (this.option(\"showSelectionControls\")) {\n      (0, _extend.extend)(result, {\n        showSelectionControls: true,\n        selectionByClick: true\n      });\n    }\n\n    return result;\n  },\n  _listFocusedItemChangeHandler: function (e) {\n    if (this._preventInputValueRender) {\n      return;\n    }\n\n    var list = e.component;\n    var focusedElement = (0, _renderer.default)(list.option(\"focusedElement\"));\n\n    var focusedItem = list._getItemData(focusedElement);\n\n    this._updateField(focusedItem);\n  },\n  _updateField: function (item) {\n    var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\n\n    if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\n      var text = this._displayGetter(item);\n\n      this.option(\"text\", text);\n\n      this._renderDisplayText(text);\n\n      return;\n    }\n\n    this._renderField();\n  },\n  _getSelectionChangeHandler: function () {\n    return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : _common.noop;\n  },\n  _selectionChangeHandler: function (e) {\n    (0, _iterator.each)(e.addedItems || [], function (_, addedItem) {\n      this._setValue(this._valueGetter(addedItem));\n    }.bind(this));\n  },\n  _getActualSearchValue: function () {\n    return this._dataSource.searchValue();\n  },\n  _toggleOpenState: function (isVisible) {\n    if (this.option(\"disabled\")) {\n      return;\n    }\n\n    isVisible = arguments.length ? isVisible : !this.option(\"opened\");\n\n    if (!isVisible && !this._shouldClearFilter()) {\n      this._restoreInputText(true);\n    }\n\n    if (this._wasSearch() && isVisible) {\n      this._wasSearch(false);\n\n      var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\n\n      if (showDataImmediately && this._dataSource) {\n        if (this._searchTimer) {\n          return;\n        }\n\n        var searchValue = this._getActualSearchValue();\n\n        searchValue && this._wasSearch(true);\n\n        this._filterDataSource(searchValue || null);\n      } else {\n        this._setListOption(\"items\", []);\n      }\n    }\n\n    if (isVisible) {\n      this._scrollToSelectedItem();\n    }\n\n    this.callBase(isVisible);\n  },\n  _renderTooltip: function () {\n    if (this.option(\"tooltipEnabled\")) {\n      this.$element().attr(\"title\", this.option(\"displayValue\"));\n    }\n  },\n  _renderDimensions: function () {\n    this.callBase();\n\n    this._dimensionChanged();\n  },\n  _isValueEqualInputText: function () {\n    var initialSelectedItem = this.option(\"selectedItem\");\n\n    if (null === initialSelectedItem) {\n      return false;\n    }\n\n    var value = this._displayGetter(initialSelectedItem);\n\n    var displayValue = value ? String(value) : \"\";\n\n    var inputText = this._searchValue();\n\n    return displayValue === inputText;\n  },\n  _popupHidingHandler: function () {\n    if (this._isValueEqualInputText()) {\n      this._cancelEditing();\n    }\n\n    this.callBase();\n  },\n  _popupHiddenHandler: function () {\n    this.callBase();\n\n    if (this._shouldCancelSearch()) {\n      this._wasSearch(false);\n\n      this._searchCanceled();\n\n      this._shouldCancelSearch(false);\n    }\n  },\n  _restoreInputText: function (saveEditingValue) {\n    if (this.option(\"readOnly\")) {\n      return;\n    }\n\n    this._loadItemDeferred && this._loadItemDeferred.always(function () {\n      var initialSelectedItem = this.option(\"selectedItem\");\n\n      if (this.option(\"acceptCustomValue\")) {\n        if (!saveEditingValue) {\n          this._updateField(initialSelectedItem);\n\n          this._clearFilter();\n        }\n\n        return;\n      }\n\n      if (this.option(\"searchEnabled\")) {\n        if (!this._searchValue() && this.option(\"allowClearing\")) {\n          this._clearTextValue();\n\n          return;\n        }\n      }\n\n      if (this._isValueEqualInputText()) {\n        return;\n      }\n\n      this._renderInputValue().always(function (selectedItem) {\n        var newSelectedItem = (0, _common.ensureDefined)(selectedItem, initialSelectedItem);\n\n        this._setSelectedItem(newSelectedItem);\n\n        this._updateField(newSelectedItem);\n\n        this._clearFilter();\n      }.bind(this));\n    }.bind(this));\n  },\n  _focusOutHandler: function (e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      var isOverlayTarget = this._isOverlayNestedTarget(e.relatedTarget);\n\n      if (!isOverlayTarget) {\n        this._restoreInputText();\n\n        this._clearSearchTimer();\n      }\n\n      this._cancelSearchIfNeed(e);\n    }\n\n    e.target = this._input().get(0);\n    this.callBase(e);\n  },\n  _cancelSearchIfNeed: function (e) {\n    var _this$option = this.option(),\n        searchEnabled = _this$option.searchEnabled;\n\n    var isOverlayTarget = this._isOverlayNestedTarget(null === e || void 0 === e ? void 0 : e.relatedTarget);\n\n    var shouldCancelSearch = this._wasSearch() && searchEnabled && !isOverlayTarget;\n\n    if (shouldCancelSearch) {\n      var _this$_popup;\n\n      var isPopupVisible = null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup._hideAnimationProcessing;\n\n      if (isPopupVisible) {\n        this._shouldCancelSearch(true);\n      } else {\n        this._wasSearch(false);\n\n        this._searchCanceled();\n      }\n    }\n  },\n  _shouldCancelSearch: function (value) {\n    if (!arguments.length) {\n      return this._shouldCancelSearchValue;\n    }\n\n    this._shouldCancelSearchValue = value;\n  },\n  _isOverlayNestedTarget: function (target) {\n    return !!(0, _renderer.default)(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length;\n  },\n  _clearTextValue: function () {\n    if (this.option(\"selectedItem\")) {\n      if (this._savedTextRemoveEvent) {\n        this._saveValueChangeEvent(this._savedTextRemoveEvent);\n      }\n\n      this.option(\"value\", null);\n    }\n\n    delete this._savedTextRemoveEvent;\n  },\n  _shouldOpenPopup: function () {\n    return this._needPassDataSourceToList() && this._wasSearch();\n  },\n  _isFocused: function () {\n    var activeElement = _dom_adapter.default.getActiveElement();\n\n    return this.callBase() && (0, _renderer.default)(activeElement).closest(this._input()).length > 0;\n  },\n  _renderValueChangeEvent: function () {\n    if (this._isEditable()) {\n      this.callBase();\n    }\n  },\n  _fieldRenderData: function () {\n    var $listFocused = this._list && this.option(\"opened\") && (0, _renderer.default)(this._list.option(\"focusedElement\"));\n\n    if ($listFocused && $listFocused.length) {\n      return this._list._getItemData($listFocused);\n    }\n\n    return this.option(\"selectedItem\");\n  },\n  _isSelectedValue: function (value) {\n    return this._isValueEquals(value, this.option(\"value\"));\n  },\n  _shouldCloseOnItemClick: function () {\n    return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"));\n  },\n  _listItemClickHandler: function (e) {\n    var previousValue = this._getCurrentValue();\n\n    this._focusListElement((0, _renderer.default)(e.itemElement));\n\n    this._saveValueChangeEvent(e.event);\n\n    this._completeSelection(this._valueGetter(e.itemData));\n\n    if (this._shouldCloseOnItemClick()) {\n      this.option(\"opened\", false);\n    }\n\n    if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\n      this._updateField(e.itemData);\n    }\n\n    if (this._shouldClearFilter()) {\n      this._cancelSearchIfNeed();\n    }\n  },\n  _shouldClearFilter: function () {\n    return this._wasSearch();\n  },\n  _completeSelection: function (value) {\n    this._setValue(value);\n  },\n  _loadItem: function (value, cache) {\n    var that = this;\n    var deferred = new _deferred.Deferred();\n    this.callBase(value, cache).done(function (item) {\n      deferred.resolve(item);\n    }.bind(this)).fail(function () {\n      var selectedItem = that.option(\"selectedItem\");\n\n      if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\n        deferred.resolve(selectedItem);\n      } else {\n        deferred.reject();\n      }\n    }.bind(this));\n    return deferred.promise();\n  },\n  _loadInputValue: function (value, callback) {\n    this._loadItemDeferred = this._loadItem(value).always(callback);\n    return this._loadItemDeferred;\n  },\n  _isCustomItemSelected: function () {\n    var selectedItem = this.option(\"selectedItem\");\n\n    var searchValue = this._searchValue();\n\n    var selectedItemText = this._displayGetter(selectedItem);\n\n    return !selectedItemText || searchValue !== selectedItemText.toString();\n  },\n  _valueChangeEventHandler: function (e) {\n    if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected() && !this._isValueChanging) {\n      this._isValueChanging = true;\n\n      this._customItemAddedHandler(e);\n\n      this._isValueChanging = false;\n    }\n  },\n  _initCustomItemCreatingAction: function () {\n    this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\");\n  },\n  _createCustomItem: function (text) {\n    var params = {\n      text: text\n    };\n\n    var actionResult = this._customItemCreatingAction(params);\n\n    var item = (0, _common.ensureDefined)(actionResult, params.customItem);\n\n    if ((0, _type.isDefined)(actionResult)) {\n      _errors.default.log(\"W0015\", \"onCustomItemCreating\", \"customItem\");\n    }\n\n    return item;\n  },\n  _customItemAddedHandler: function (e) {\n    var searchValue = this._searchValue();\n\n    var item = this._createCustomItem(searchValue);\n\n    this._saveValueChangeEvent(e);\n\n    if (void 0 === item) {\n      this._renderValue();\n\n      throw _errors.default.Error(\"E0121\");\n    }\n\n    if ((0, _type.isPromise)(item)) {\n      (0, _deferred.fromPromise)(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null));\n    } else {\n      this._setCustomItem(item);\n    }\n  },\n  _setCustomItem: function (item) {\n    if (this._disposed) {\n      return;\n    }\n\n    item = item || null;\n    this.option(\"selectedItem\", item);\n\n    this._cancelSearchIfNeed();\n\n    this._setValue(this._valueGetter(item));\n\n    this._renderDisplayText(this._displayGetter(item));\n  },\n  _clearValueHandler: function (e) {\n    this.callBase(e);\n    return false;\n  },\n  _wasSearch: function (value) {\n    if (!arguments.length) {\n      return this._wasSearchValue;\n    }\n\n    this._wasSearchValue = value;\n  },\n  _searchHandler: function (e) {\n    if (this._preventFiltering) {\n      delete this._preventFiltering;\n      return;\n    }\n\n    if (this._needPassDataSourceToList()) {\n      this._wasSearch(true);\n    }\n\n    this.callBase(e);\n  },\n  _dataSourceFiltered: function (searchValue) {\n    this.callBase();\n\n    if (null !== searchValue) {\n      this._renderInputSubstitution();\n\n      this._renderFocusedElement();\n    }\n  },\n  _valueSubstituted: function () {\n    var input = this._input().get(0);\n\n    var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\n\n    var inputHasSelection = input.selectionStart !== input.selectionEnd;\n    return this._wasSearch() && inputHasSelection && !isAllSelected;\n  },\n  _shouldSubstitutionBeRendered: function () {\n    return !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\");\n  },\n  _renderInputSubstitution: function () {\n    if (!this._shouldSubstitutionBeRendered()) {\n      delete this._preventSubstitution;\n      return;\n    }\n\n    var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\n\n    if (!item) {\n      return;\n    }\n\n    var $input = this._input();\n\n    var valueLength = $input.val().length;\n\n    if (0 === valueLength) {\n      return;\n    }\n\n    var inputElement = $input.get(0);\n\n    var displayValue = this._displayGetter(item).toString();\n\n    inputElement.value = displayValue;\n\n    this._caret({\n      start: valueLength,\n      end: displayValue.length\n    });\n  },\n  _dispose: function () {\n    this._renderInputValueAsync = _common.noop;\n    delete this._loadItemDeferred;\n    this.callBase();\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"onCustomItemCreating\":\n        this._initCustomItemCreatingAction();\n\n        break;\n\n      case \"tooltipEnabled\":\n        this._renderTooltip();\n\n        break;\n\n      case \"displayCustomValue\":\n      case \"acceptCustomValue\":\n      case \"showSelectionControls\":\n      case \"useInkRipple\":\n        this._invalidate();\n\n        break;\n\n      case \"allowClearing\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clean: function () {\n    delete this._inkRipple;\n    this.callBase();\n  }\n});\n\n(0, _component_registrator.default)(\"dxSelectBox\", SelectBox);\nvar _default = SelectBox;\nexports.default = _default;\nmodule.exports = exports.default;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/ui/select_box.js"],"names":["exports","default","_renderer","_interopRequireDefault","require","_common","_type","_extend","_array","_iterator","_deferred","_element","_errors","_dom_adapter","_utils","_message","_component_registrator","_ui","_index","obj","__esModule","DISABLED_STATE_SELECTOR","SELECTBOX_CLASS","SELECTBOX_POPUP_CLASS","SELECTBOX_CONTAINER_CLASS","SELECTBOX_POPUP_WRAPPER_CLASS","SelectBox","inherit","_supportedKeys","that","parent","callBase","clearSelectBox","e","isEditable","_isEditable","option","preventDefault","reset","_valueSubstituted","_preventFiltering","_savedTextRemoveEvent","_preventSubstitution","searchIfNeeded","_searchHandler","extend","tab","_resetCaretPosition","apply","arguments","_cancelSearchIfNeed","upArrow","_setNextValue","downArrow","leftArrow","rightArrow","home","end","escape","result","_cancelEditing","enter","isOpened","inputText","_input","val","trim","isCustomText","_list","isDefined","_saveValueChangeEvent","selectedItem","value","close","_toggleOpenState","_valueChangeEventHandler","space","isSearchEnabled","acceptCustomValue","backspace","del","_getDefaultOptions","placeholder","format","fieldTemplate","valueChangeEvent","onCustomItemCreating","customItem","text","showSelectionControls","allowClearing","tooltipEnabled","openOnFieldClick","showDropDownButton","displayCustomValue","useInkRipple","useHiddenSubmitElement","_init","_initCustomItemCreatingAction","_initMarkup","$element","addClass","_renderTooltip","_renderInkRipple","_$container","_inkRipple","render","_toggleActiveState","config","element","_inputWrapper","event","showWave","hideWave","_createPopup","_popup","overlayContent","attr","_popupWrapperClass","_focusListElement","_updateField","_renderOpenedState","_scrollToSelectedItem","_focusSelectedElement","searchValue","_searchValue","$listItems","_itemElements","index","inArray","focusedElement","_isCustomItemSelected","eq","_renderFocusedElement","not","_preventInputValueRender","getPublicElement","scrollToItem","_listContentReadyHandler","isPaginate","_dataSource","paginate","_needPopupRepaint","_renderValue","_renderInputValue","_setSubmitValue","Deferred","resolve","always","_renderInputValueAsync","bind","_renderInputValueImpl","_refreshSelected","_renderField","_setNextItem","step","item","_calcNextItem","_valueGetter","_setValue","dataSourceIsLoaded","isLoaded","load","done","selectedIndex","_getSelectedIndex","hasPages","pageSize","isLastPage","isLastItem","_items","length","normalizeKeyName","isLoading","_loadNextPage","_setSelectedItem","isUnknownItem","_isCustomValueAllowed","_setListOption","_displayValue","_listConfig","pageLoadMode","onSelectionChanged","_getSelectionChangeHandler","onFocusedItemChanged","_listFocusedItemChangeHandler","selectionByClick","list","component","focusedItem","_getItemData","_getTemplateByOption","_displayGetter","_renderDisplayText","_selectionChangeHandler","noop","each","addedItems","_","addedItem","_getActualSearchValue","isVisible","_shouldClearFilter","_restoreInputText","_wasSearch","showDataImmediately","_searchTimer","_filterDataSource","_renderDimensions","_dimensionChanged","_isValueEqualInputText","initialSelectedItem","displayValue","String","_popupHidingHandler","_popupHiddenHandler","_shouldCancelSearch","_searchCanceled","saveEditingValue","_loadItemDeferred","_clearFilter","_clearTextValue","newSelectedItem","ensureDefined","_focusOutHandler","_preventNestedFocusEvent","isOverlayTarget","_isOverlayNestedTarget","relatedTarget","_clearSearchTimer","target","get","_this$option","searchEnabled","shouldCancelSearch","_this$_popup","isPopupVisible","_hideAnimationProcessing","_shouldCancelSearchValue","closest","concat","_shouldOpenPopup","_needPassDataSourceToList","_isFocused","activeElement","getActiveElement","_renderValueChangeEvent","_fieldRenderData","$listFocused","_isSelectedValue","_isValueEquals","_shouldCloseOnItemClick","_listItemClickHandler","previousValue","_getCurrentValue","itemElement","_completeSelection","itemData","_loadItem","cache","deferred","fail","reject","promise","_loadInputValue","callback","selectedItemText","toString","_isValueChanging","_customItemAddedHandler","_customItemCreatingAction","_createActionByOption","_createCustomItem","params","actionResult","log","Error","isPromise","fromPromise","_setCustomItem","_disposed","_clearValueHandler","_wasSearchValue","_dataSourceFiltered","_renderInputSubstitution","input","isAllSelected","selectionStart","selectionEnd","inputHasSelection","_shouldSubstitutionBeRendered","_getPlainItems","$input","valueLength","inputElement","_caret","start","_dispose","_optionChanged","args","name","_invalidate","_clean","_default","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 20.2.7\r\n * Build date: Thu Apr 22 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _renderer = _interopRequireDefault(require(\"../core/renderer\"));\r\nvar _common = require(\"../core/utils/common\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _array = require(\"../core/utils/array\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _deferred = require(\"../core/utils/deferred\");\r\nvar _element = require(\"../core/element\");\r\nvar _errors = _interopRequireDefault(require(\"../core/errors\"));\r\nvar _dom_adapter = _interopRequireDefault(require(\"../core/dom_adapter\"));\r\nvar _utils = require(\"./widget/utils.ink_ripple\");\r\nvar _message = _interopRequireDefault(require(\"../localization/message\"));\r\nvar _component_registrator = _interopRequireDefault(require(\"../core/component_registrator\"));\r\nvar _ui = _interopRequireDefault(require(\"./drop_down_editor/ui.drop_down_list\"));\r\nvar _index = require(\"../events/utils/index\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\r\nvar SELECTBOX_CLASS = \"dx-selectbox\";\r\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\r\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\r\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\r\nvar SelectBox = _ui.default.inherit({\r\n    _supportedKeys: function() {\r\n        var that = this;\r\n        var parent = this.callBase();\r\n        var clearSelectBox = function(e) {\r\n            var isEditable = this._isEditable();\r\n            if (!isEditable) {\r\n                if (this.option(\"showClearButton\")) {\r\n                    e.preventDefault();\r\n                    this.reset()\r\n                }\r\n            } else {\r\n                if (this._valueSubstituted()) {\r\n                    this._preventFiltering = true\r\n                }\r\n            }\r\n            this._savedTextRemoveEvent = e;\r\n            this._preventSubstitution = true\r\n        };\r\n        var searchIfNeeded = function() {\r\n            if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\r\n                that._searchHandler()\r\n            }\r\n        };\r\n        return (0, _extend.extend)({}, parent, {\r\n            tab: function() {\r\n                if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\r\n                    this._resetCaretPosition(true)\r\n                }\r\n                parent.tab && parent.tab.apply(this, arguments);\r\n                this._cancelSearchIfNeed()\r\n            },\r\n            upArrow: function(e) {\r\n                if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            downArrow: function(e) {\r\n                if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            leftArrow: function() {\r\n                searchIfNeeded();\r\n                parent.leftArrow && parent.leftArrow.apply(this, arguments)\r\n            },\r\n            rightArrow: function() {\r\n                searchIfNeeded();\r\n                parent.rightArrow && parent.rightArrow.apply(this, arguments)\r\n            },\r\n            home: function() {\r\n                searchIfNeeded();\r\n                parent.home && parent.home.apply(this, arguments)\r\n            },\r\n            end: function() {\r\n                searchIfNeeded();\r\n                parent.end && parent.end.apply(this, arguments)\r\n            },\r\n            escape: function() {\r\n                var result = parent.escape && parent.escape.apply(this, arguments);\r\n                this._cancelEditing();\r\n                return null !== result && void 0 !== result ? result : true\r\n            },\r\n            enter: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var inputText = this._input().val().trim();\r\n                var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\r\n                if (!inputText && (0, _type.isDefined)(this.option(\"value\")) && this.option(\"allowClearing\")) {\r\n                    this._saveValueChangeEvent(e);\r\n                    this.option({\r\n                        selectedItem: null,\r\n                        value: null\r\n                    });\r\n                    this.close()\r\n                } else {\r\n                    if (this.option(\"acceptCustomValue\")) {\r\n                        e.preventDefault();\r\n                        if (isCustomText) {\r\n                            if (isOpened) {\r\n                                this._toggleOpenState()\r\n                            }\r\n                            this._valueChangeEventHandler(e)\r\n                        }\r\n                        return isOpened\r\n                    }\r\n                    if (parent.enter && parent.enter.apply(this, arguments)) {\r\n                        return isOpened\r\n                    }\r\n                }\r\n            },\r\n            space: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var isSearchEnabled = this.option(\"searchEnabled\");\r\n                var acceptCustomValue = this.option(\"acceptCustomValue\");\r\n                if (!isOpened || isSearchEnabled || acceptCustomValue) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                this._valueChangeEventHandler(e);\r\n                return true\r\n            },\r\n            backspace: clearSelectBox,\r\n            del: clearSelectBox\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            placeholder: _message.default.format(\"Select\"),\r\n            fieldTemplate: null,\r\n            valueChangeEvent: \"change\",\r\n            acceptCustomValue: false,\r\n            onCustomItemCreating: function(e) {\r\n                if (!(0, _type.isDefined)(e.customItem)) {\r\n                    e.customItem = e.text\r\n                }\r\n            },\r\n            showSelectionControls: false,\r\n            allowClearing: true,\r\n            tooltipEnabled: false,\r\n            openOnFieldClick: true,\r\n            showDropDownButton: true,\r\n            displayCustomValue: false,\r\n            useInkRipple: false,\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initCustomItemCreatingAction()\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(SELECTBOX_CLASS);\r\n        this._renderTooltip();\r\n        this.option(\"useInkRipple\") && this._renderInkRipple();\r\n        this.callBase();\r\n        this._$container.addClass(SELECTBOX_CONTAINER_CLASS)\r\n    },\r\n    _renderInkRipple: function() {\r\n        this._inkRipple = (0, _utils.render)()\r\n    },\r\n    _toggleActiveState: function($element, value, e) {\r\n        this.callBase.apply(this, arguments);\r\n        if (!this._inkRipple || this._isEditable()) {\r\n            return\r\n        }\r\n        var config = {\r\n            element: this._inputWrapper(),\r\n            event: e\r\n        };\r\n        if (value) {\r\n            this._inkRipple.showWave(config)\r\n        } else {\r\n            this._inkRipple.hideWave(config)\r\n        }\r\n    },\r\n    _createPopup: function() {\r\n        this.callBase();\r\n        this._popup.$element().addClass(SELECTBOX_POPUP_CLASS);\r\n        this._popup.overlayContent().attr(\"tabindex\", -1)\r\n    },\r\n    _popupWrapperClass: function() {\r\n        return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS\r\n    },\r\n    _cancelEditing: function() {\r\n        if (!this.option(\"searchEnabled\") && this._list) {\r\n            this._focusListElement(null);\r\n            this._updateField(this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _renderOpenedState: function() {\r\n        this.callBase();\r\n        if (this.option(\"opened\")) {\r\n            this._scrollToSelectedItem();\r\n            this._focusSelectedElement()\r\n        }\r\n    },\r\n    _focusSelectedElement: function() {\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var index = (0, _array.inArray)(this.option(\"selectedItem\"), this.option(\"items\"));\r\n        var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _renderFocusedElement: function() {\r\n        if (!this._list) {\r\n            return\r\n        }\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue || this.option(\"acceptCustomValue\")) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _focusListElement: function(element) {\r\n        this._preventInputValueRender = true;\r\n        this._list.option(\"focusedElement\", (0, _element.getPublicElement)(element));\r\n        delete this._preventInputValueRender\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"))\r\n    },\r\n    _listContentReadyHandler: function() {\r\n        this.callBase();\r\n        var isPaginate = this._dataSource && this._dataSource.paginate();\r\n        if (isPaginate && this._needPopupRepaint()) {\r\n            return\r\n        }\r\n        this._scrollToSelectedItem()\r\n    },\r\n    _renderValue: function() {\r\n        this._renderInputValue();\r\n        this._setSubmitValue();\r\n        return (new _deferred.Deferred).resolve()\r\n    },\r\n    _renderInputValue: function() {\r\n        return this.callBase().always(function() {\r\n            this._renderInputValueAsync()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueAsync: function() {\r\n        this._renderTooltip();\r\n        this._renderInputValueImpl().always(function() {\r\n            this._refreshSelected()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueImpl: function() {\r\n        this._renderField();\r\n        return (new _deferred.Deferred).resolve()\r\n    },\r\n    _setNextItem: function(step) {\r\n        var item = this._calcNextItem(step);\r\n        var value = this._valueGetter(item);\r\n        this._setValue(value)\r\n    },\r\n    _setNextValue: function(e) {\r\n        var dataSourceIsLoaded = this._dataSource.isLoaded() ? (new _deferred.Deferred).resolve() : this._dataSource.load();\r\n        dataSourceIsLoaded.done(function() {\r\n            var selectedIndex = this._getSelectedIndex();\r\n            var hasPages = this._dataSource.pageSize();\r\n            var isLastPage = this._dataSource.isLastPage();\r\n            var isLastItem = selectedIndex === this._items().length - 1;\r\n            this._saveValueChangeEvent(e);\r\n            var step = \"downArrow\" === (0, _index.normalizeKeyName)(e) ? 1 : -1;\r\n            if (hasPages && !isLastPage && isLastItem && step > 0) {\r\n                if (!this._popup) {\r\n                    this._createPopup()\r\n                }\r\n                if (!this._dataSource.isLoading()) {\r\n                    this._list._loadNextPage().done(this._setNextItem.bind(this, step))\r\n                }\r\n            } else {\r\n                this._setNextItem(step)\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _setSelectedItem: function(item) {\r\n        var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\r\n        this.callBase(isUnknownItem ? null : item);\r\n        if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\r\n            this._setListOption(\"selectedItem\", this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _isCustomValueAllowed: function() {\r\n        return this.option(\"acceptCustomValue\") || this.callBase()\r\n    },\r\n    _displayValue: function(item) {\r\n        item = !(0, _type.isDefined)(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\r\n        return this.callBase(item)\r\n    },\r\n    _listConfig: function() {\r\n        var result = (0, _extend.extend)(this.callBase(), {\r\n            pageLoadMode: \"scrollBottom\",\r\n            onSelectionChanged: this._getSelectionChangeHandler(),\r\n            selectedItem: this.option(\"selectedItem\"),\r\n            onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\r\n        });\r\n        if (this.option(\"showSelectionControls\")) {\r\n            (0, _extend.extend)(result, {\r\n                showSelectionControls: true,\r\n                selectionByClick: true\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _listFocusedItemChangeHandler: function(e) {\r\n        if (this._preventInputValueRender) {\r\n            return\r\n        }\r\n        var list = e.component;\r\n        var focusedElement = (0, _renderer.default)(list.option(\"focusedElement\"));\r\n        var focusedItem = list._getItemData(focusedElement);\r\n        this._updateField(focusedItem)\r\n    },\r\n    _updateField: function(item) {\r\n        var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\r\n        if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\r\n            var text = this._displayGetter(item);\r\n            this.option(\"text\", text);\r\n            this._renderDisplayText(text);\r\n            return\r\n        }\r\n        this._renderField()\r\n    },\r\n    _getSelectionChangeHandler: function() {\r\n        return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : _common.noop\r\n    },\r\n    _selectionChangeHandler: function(e) {\r\n        (0, _iterator.each)(e.addedItems || [], function(_, addedItem) {\r\n            this._setValue(this._valueGetter(addedItem))\r\n        }.bind(this))\r\n    },\r\n    _getActualSearchValue: function() {\r\n        return this._dataSource.searchValue()\r\n    },\r\n    _toggleOpenState: function(isVisible) {\r\n        if (this.option(\"disabled\")) {\r\n            return\r\n        }\r\n        isVisible = arguments.length ? isVisible : !this.option(\"opened\");\r\n        if (!isVisible && !this._shouldClearFilter()) {\r\n            this._restoreInputText(true)\r\n        }\r\n        if (this._wasSearch() && isVisible) {\r\n            this._wasSearch(false);\r\n            var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\r\n            if (showDataImmediately && this._dataSource) {\r\n                if (this._searchTimer) {\r\n                    return\r\n                }\r\n                var searchValue = this._getActualSearchValue();\r\n                searchValue && this._wasSearch(true);\r\n                this._filterDataSource(searchValue || null)\r\n            } else {\r\n                this._setListOption(\"items\", [])\r\n            }\r\n        }\r\n        if (isVisible) {\r\n            this._scrollToSelectedItem()\r\n        }\r\n        this.callBase(isVisible)\r\n    },\r\n    _renderTooltip: function() {\r\n        if (this.option(\"tooltipEnabled\")) {\r\n            this.$element().attr(\"title\", this.option(\"displayValue\"))\r\n        }\r\n    },\r\n    _renderDimensions: function() {\r\n        this.callBase();\r\n        this._dimensionChanged()\r\n    },\r\n    _isValueEqualInputText: function() {\r\n        var initialSelectedItem = this.option(\"selectedItem\");\r\n        if (null === initialSelectedItem) {\r\n            return false\r\n        }\r\n        var value = this._displayGetter(initialSelectedItem);\r\n        var displayValue = value ? String(value) : \"\";\r\n        var inputText = this._searchValue();\r\n        return displayValue === inputText\r\n    },\r\n    _popupHidingHandler: function() {\r\n        if (this._isValueEqualInputText()) {\r\n            this._cancelEditing()\r\n        }\r\n        this.callBase()\r\n    },\r\n    _popupHiddenHandler: function() {\r\n        this.callBase();\r\n        if (this._shouldCancelSearch()) {\r\n            this._wasSearch(false);\r\n            this._searchCanceled();\r\n            this._shouldCancelSearch(false)\r\n        }\r\n    },\r\n    _restoreInputText: function(saveEditingValue) {\r\n        if (this.option(\"readOnly\")) {\r\n            return\r\n        }\r\n        this._loadItemDeferred && this._loadItemDeferred.always(function() {\r\n            var initialSelectedItem = this.option(\"selectedItem\");\r\n            if (this.option(\"acceptCustomValue\")) {\r\n                if (!saveEditingValue) {\r\n                    this._updateField(initialSelectedItem);\r\n                    this._clearFilter()\r\n                }\r\n                return\r\n            }\r\n            if (this.option(\"searchEnabled\")) {\r\n                if (!this._searchValue() && this.option(\"allowClearing\")) {\r\n                    this._clearTextValue();\r\n                    return\r\n                }\r\n            }\r\n            if (this._isValueEqualInputText()) {\r\n                return\r\n            }\r\n            this._renderInputValue().always(function(selectedItem) {\r\n                var newSelectedItem = (0, _common.ensureDefined)(selectedItem, initialSelectedItem);\r\n                this._setSelectedItem(newSelectedItem);\r\n                this._updateField(newSelectedItem);\r\n                this._clearFilter()\r\n            }.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            var isOverlayTarget = this._isOverlayNestedTarget(e.relatedTarget);\r\n            if (!isOverlayTarget) {\r\n                this._restoreInputText();\r\n                this._clearSearchTimer()\r\n            }\r\n            this._cancelSearchIfNeed(e)\r\n        }\r\n        e.target = this._input().get(0);\r\n        this.callBase(e)\r\n    },\r\n    _cancelSearchIfNeed: function(e) {\r\n        var _this$option = this.option(),\r\n            searchEnabled = _this$option.searchEnabled;\r\n        var isOverlayTarget = this._isOverlayNestedTarget(null === e || void 0 === e ? void 0 : e.relatedTarget);\r\n        var shouldCancelSearch = this._wasSearch() && searchEnabled && !isOverlayTarget;\r\n        if (shouldCancelSearch) {\r\n            var _this$_popup;\r\n            var isPopupVisible = null === (_this$_popup = this._popup) || void 0 === _this$_popup ? void 0 : _this$_popup._hideAnimationProcessing;\r\n            if (isPopupVisible) {\r\n                this._shouldCancelSearch(true)\r\n            } else {\r\n                this._wasSearch(false);\r\n                this._searchCanceled()\r\n            }\r\n        }\r\n    },\r\n    _shouldCancelSearch: function(value) {\r\n        if (!arguments.length) {\r\n            return this._shouldCancelSearchValue\r\n        }\r\n        this._shouldCancelSearchValue = value\r\n    },\r\n    _isOverlayNestedTarget: function(target) {\r\n        return !!(0, _renderer.default)(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length\r\n    },\r\n    _clearTextValue: function() {\r\n        if (this.option(\"selectedItem\")) {\r\n            if (this._savedTextRemoveEvent) {\r\n                this._saveValueChangeEvent(this._savedTextRemoveEvent)\r\n            }\r\n            this.option(\"value\", null)\r\n        }\r\n        delete this._savedTextRemoveEvent\r\n    },\r\n    _shouldOpenPopup: function() {\r\n        return this._needPassDataSourceToList() && this._wasSearch()\r\n    },\r\n    _isFocused: function() {\r\n        var activeElement = _dom_adapter.default.getActiveElement();\r\n        return this.callBase() && (0, _renderer.default)(activeElement).closest(this._input()).length > 0\r\n    },\r\n    _renderValueChangeEvent: function() {\r\n        if (this._isEditable()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _fieldRenderData: function() {\r\n        var $listFocused = this._list && this.option(\"opened\") && (0, _renderer.default)(this._list.option(\"focusedElement\"));\r\n        if ($listFocused && $listFocused.length) {\r\n            return this._list._getItemData($listFocused)\r\n        }\r\n        return this.option(\"selectedItem\")\r\n    },\r\n    _isSelectedValue: function(value) {\r\n        return this._isValueEquals(value, this.option(\"value\"))\r\n    },\r\n    _shouldCloseOnItemClick: function() {\r\n        return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"))\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        var previousValue = this._getCurrentValue();\r\n        this._focusListElement((0, _renderer.default)(e.itemElement));\r\n        this._saveValueChangeEvent(e.event);\r\n        this._completeSelection(this._valueGetter(e.itemData));\r\n        if (this._shouldCloseOnItemClick()) {\r\n            this.option(\"opened\", false)\r\n        }\r\n        if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\r\n            this._updateField(e.itemData)\r\n        }\r\n        if (this._shouldClearFilter()) {\r\n            this._cancelSearchIfNeed()\r\n        }\r\n    },\r\n    _shouldClearFilter: function() {\r\n        return this._wasSearch()\r\n    },\r\n    _completeSelection: function(value) {\r\n        this._setValue(value)\r\n    },\r\n    _loadItem: function(value, cache) {\r\n        var that = this;\r\n        var deferred = new _deferred.Deferred;\r\n        this.callBase(value, cache).done(function(item) {\r\n            deferred.resolve(item)\r\n        }.bind(this)).fail(function() {\r\n            var selectedItem = that.option(\"selectedItem\");\r\n            if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\r\n                deferred.resolve(selectedItem)\r\n            } else {\r\n                deferred.reject()\r\n            }\r\n        }.bind(this));\r\n        return deferred.promise()\r\n    },\r\n    _loadInputValue: function(value, callback) {\r\n        this._loadItemDeferred = this._loadItem(value).always(callback);\r\n        return this._loadItemDeferred\r\n    },\r\n    _isCustomItemSelected: function() {\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        var searchValue = this._searchValue();\r\n        var selectedItemText = this._displayGetter(selectedItem);\r\n        return !selectedItemText || searchValue !== selectedItemText.toString()\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected() && !this._isValueChanging) {\r\n            this._isValueChanging = true;\r\n            this._customItemAddedHandler(e);\r\n            this._isValueChanging = false\r\n        }\r\n    },\r\n    _initCustomItemCreatingAction: function() {\r\n        this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\")\r\n    },\r\n    _createCustomItem: function(text) {\r\n        var params = {\r\n            text: text\r\n        };\r\n        var actionResult = this._customItemCreatingAction(params);\r\n        var item = (0, _common.ensureDefined)(actionResult, params.customItem);\r\n        if ((0, _type.isDefined)(actionResult)) {\r\n            _errors.default.log(\"W0015\", \"onCustomItemCreating\", \"customItem\")\r\n        }\r\n        return item\r\n    },\r\n    _customItemAddedHandler: function(e) {\r\n        var searchValue = this._searchValue();\r\n        var item = this._createCustomItem(searchValue);\r\n        this._saveValueChangeEvent(e);\r\n        if (void 0 === item) {\r\n            this._renderValue();\r\n            throw _errors.default.Error(\"E0121\")\r\n        }\r\n        if ((0, _type.isPromise)(item)) {\r\n            (0, _deferred.fromPromise)(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null))\r\n        } else {\r\n            this._setCustomItem(item)\r\n        }\r\n    },\r\n    _setCustomItem: function(item) {\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        item = item || null;\r\n        this.option(\"selectedItem\", item);\r\n        this._cancelSearchIfNeed();\r\n        this._setValue(this._valueGetter(item));\r\n        this._renderDisplayText(this._displayGetter(item))\r\n    },\r\n    _clearValueHandler: function(e) {\r\n        this.callBase(e);\r\n        return false\r\n    },\r\n    _wasSearch: function(value) {\r\n        if (!arguments.length) {\r\n            return this._wasSearchValue\r\n        }\r\n        this._wasSearchValue = value\r\n    },\r\n    _searchHandler: function(e) {\r\n        if (this._preventFiltering) {\r\n            delete this._preventFiltering;\r\n            return\r\n        }\r\n        if (this._needPassDataSourceToList()) {\r\n            this._wasSearch(true)\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _dataSourceFiltered: function(searchValue) {\r\n        this.callBase();\r\n        if (null !== searchValue) {\r\n            this._renderInputSubstitution();\r\n            this._renderFocusedElement()\r\n        }\r\n    },\r\n    _valueSubstituted: function() {\r\n        var input = this._input().get(0);\r\n        var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\r\n        var inputHasSelection = input.selectionStart !== input.selectionEnd;\r\n        return this._wasSearch() && inputHasSelection && !isAllSelected\r\n    },\r\n    _shouldSubstitutionBeRendered: function() {\r\n        return !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\")\r\n    },\r\n    _renderInputSubstitution: function() {\r\n        if (!this._shouldSubstitutionBeRendered()) {\r\n            delete this._preventSubstitution;\r\n            return\r\n        }\r\n        var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\r\n        if (!item) {\r\n            return\r\n        }\r\n        var $input = this._input();\r\n        var valueLength = $input.val().length;\r\n        if (0 === valueLength) {\r\n            return\r\n        }\r\n        var inputElement = $input.get(0);\r\n        var displayValue = this._displayGetter(item).toString();\r\n        inputElement.value = displayValue;\r\n        this._caret({\r\n            start: valueLength,\r\n            end: displayValue.length\r\n        })\r\n    },\r\n    _dispose: function() {\r\n        this._renderInputValueAsync = _common.noop;\r\n        delete this._loadItemDeferred;\r\n        this.callBase()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"onCustomItemCreating\":\r\n                this._initCustomItemCreatingAction();\r\n                break;\r\n            case \"tooltipEnabled\":\r\n                this._renderTooltip();\r\n                break;\r\n            case \"displayCustomValue\":\r\n            case \"acceptCustomValue\":\r\n            case \"showSelectionControls\":\r\n            case \"useInkRipple\":\r\n                this._invalidate();\r\n                break;\r\n            case \"allowClearing\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _clean: function() {\r\n        delete this._inkRipple;\r\n        this.callBase()\r\n    }\r\n});\r\n(0, _component_registrator.default)(\"dxSelectBox\", SelectBox);\r\nvar _default = SelectBox;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}