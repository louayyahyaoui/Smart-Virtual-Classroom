{"ast":null,"code":"/**\r\n * DevExtreme (ui/number_box/number_box.caret.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.getCaretInBoundaries = getCaretInBoundaries;\nexports.getCaretOffset = exports.isCaretInBoundaries = exports.getCaretAfterFormat = exports.getCaretWithOffset = exports.getCaretBoundaries = void 0;\n\nvar _math = require(\"../../core/utils/math\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _number = _interopRequireDefault(require(\"../../localization/number\"));\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar getCaretBoundaries = function (text, format) {\n  if (\"string\" === typeof format) {\n    var signParts = format.split(\";\");\n\n    var sign = _number.default.getSign(text, format);\n\n    signParts[1] = signParts[1] || \"-\" + signParts[0];\n    format = signParts[sign < 0 ? 1 : 0];\n\n    var mockEscapedStubs = function (str) {\n      return str.replace(/'([^']*)'/g, function (str) {\n        return str.split(\"\").map(function () {\n          return \" \";\n        }).join(\"\").substr(2);\n      });\n    };\n\n    format = mockEscapedStubs(format);\n    var prefixStubLength = /^[^#0.,]*/.exec(format)[0].length;\n    var postfixStubLength = /[^#0.,]*$/.exec(format)[0].length;\n    return {\n      start: prefixStubLength,\n      end: text.length - postfixStubLength\n    };\n  } else {\n    return {\n      start: 0,\n      end: text.length\n    };\n  }\n};\n\nexports.getCaretBoundaries = getCaretBoundaries;\n\nvar _getDigitCountBeforeIndex = function (index, text) {\n  var decimalSeparator = _number.default.getDecimalSeparator();\n\n  var regExp = new RegExp(\"[^0-9\" + (0, _common.escapeRegExp)(decimalSeparator) + \"]\", \"g\");\n  var textBeforePosition = text.slice(0, index);\n  return textBeforePosition.replace(regExp, \"\").length;\n};\n\nvar _reverseText = function (text) {\n  return text.split(\"\").reverse().join(\"\");\n};\n\nvar _getDigitPositionByIndex = function (digitIndex, text) {\n  if (!digitIndex) {\n    return -1;\n  }\n\n  var regExp = /[0-9]/g;\n  var counter = 1;\n  var index = null;\n  var result = regExp.exec(text);\n\n  while (result) {\n    index = result.index;\n\n    if (!digitIndex || counter >= digitIndex) {\n      return index;\n    }\n\n    counter++;\n    result = regExp.exec(text);\n  }\n\n  return null === index ? text.length : index;\n};\n\nvar _trimNonNumericCharsFromEnd = function (text) {\n  return text.replace(/[^0-9e]+$/, \"\");\n};\n\nvar getCaretWithOffset = function (caret, offset) {\n  if (void 0 === caret.start) {\n    caret = {\n      start: caret,\n      end: caret\n    };\n  }\n\n  return {\n    start: caret.start + offset,\n    end: caret.end + offset\n  };\n};\n\nexports.getCaretWithOffset = getCaretWithOffset;\n\nvar getCaretAfterFormat = function (text, formatted, caret, format) {\n  caret = getCaretWithOffset(caret, 0);\n\n  var point = _number.default.getDecimalSeparator();\n\n  var isSeparatorBasedText = isSeparatorBasedString(text);\n  var realSeparatorOccurrenceIndex = (0, _utils.getRealSeparatorIndex)(format).occurrence;\n  var pointPosition = isSeparatorBasedText ? 0 : (0, _utils.getNthOccurrence)(text, point, realSeparatorOccurrenceIndex);\n  var newPointPosition = (0, _utils.getNthOccurrence)(formatted, point, realSeparatorOccurrenceIndex);\n  var textParts = (0, _utils.splitByIndex)(text, pointPosition);\n  var formattedParts = (0, _utils.splitByIndex)(formatted, newPointPosition);\n  var isCaretOnFloat = pointPosition !== -1 && caret.start > pointPosition;\n\n  if (isCaretOnFloat) {\n    var relativeIndex = caret.start - pointPosition - 1;\n\n    var digitsBefore = _getDigitCountBeforeIndex(relativeIndex, textParts[1]);\n\n    var newPosition = formattedParts[1] ? newPointPosition + 1 + _getDigitPositionByIndex(digitsBefore, formattedParts[1]) + 1 : formatted.length;\n    return getCaretInBoundaries(newPosition, formatted, format);\n  } else {\n    var formattedIntPart = _trimNonNumericCharsFromEnd(formattedParts[0]);\n\n    var positionFromEnd = textParts[0].length - caret.start;\n\n    var digitsFromEnd = _getDigitCountBeforeIndex(positionFromEnd, _reverseText(textParts[0]));\n\n    var newPositionFromEnd = _getDigitPositionByIndex(digitsFromEnd, _reverseText(formattedIntPart));\n\n    var newPositionFromBegin = formattedIntPart.length - (newPositionFromEnd + 1);\n    return getCaretInBoundaries(newPositionFromBegin, formatted, format);\n  }\n};\n\nexports.getCaretAfterFormat = getCaretAfterFormat;\n\nfunction isSeparatorBasedString(text) {\n  return 1 === text.length && !!text.match(/^[,.][0-9]*$/g);\n}\n\nvar isCaretInBoundaries = function (caret, text, format) {\n  caret = getCaretWithOffset(caret, 0);\n  var boundaries = getCaretInBoundaries(caret, text, format);\n  return caret.start >= boundaries.start && caret.end <= boundaries.end;\n};\n\nexports.isCaretInBoundaries = isCaretInBoundaries;\n\nfunction getCaretInBoundaries(caret, text, format) {\n  caret = getCaretWithOffset(caret, 0);\n  var boundaries = getCaretBoundaries(text, format);\n  var adjustedCaret = {\n    start: (0, _math.fitIntoRange)(caret.start, boundaries.start, boundaries.end),\n    end: (0, _math.fitIntoRange)(caret.end, boundaries.start, boundaries.end)\n  };\n  return adjustedCaret;\n}\n\nvar getCaretOffset = function (previousText, newText, format) {\n  var previousBoundaries = getCaretBoundaries(previousText, format);\n  var newBoundaries = getCaretBoundaries(newText, format);\n  return newBoundaries.start - previousBoundaries.start;\n};\n\nexports.getCaretOffset = getCaretOffset;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/ui/number_box/number_box.caret.js"],"names":["exports","getCaretInBoundaries","getCaretOffset","isCaretInBoundaries","getCaretAfterFormat","getCaretWithOffset","getCaretBoundaries","_math","require","_common","_number","_interopRequireDefault","_utils","obj","__esModule","text","format","signParts","split","sign","default","getSign","mockEscapedStubs","str","replace","map","join","substr","prefixStubLength","exec","length","postfixStubLength","start","end","_getDigitCountBeforeIndex","index","decimalSeparator","getDecimalSeparator","regExp","RegExp","escapeRegExp","textBeforePosition","slice","_reverseText","reverse","_getDigitPositionByIndex","digitIndex","counter","result","_trimNonNumericCharsFromEnd","caret","offset","formatted","point","isSeparatorBasedText","isSeparatorBasedString","realSeparatorOccurrenceIndex","getRealSeparatorIndex","occurrence","pointPosition","getNthOccurrence","newPointPosition","textParts","splitByIndex","formattedParts","isCaretOnFloat","relativeIndex","digitsBefore","newPosition","formattedIntPart","positionFromEnd","digitsFromEnd","newPositionFromEnd","newPositionFromBegin","match","boundaries","adjustedCaret","fitIntoRange","previousText","newText","previousBoundaries","newBoundaries"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/number_box/number_box.caret.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.getCaretInBoundaries = getCaretInBoundaries;\r\nexports.getCaretOffset = exports.isCaretInBoundaries = exports.getCaretAfterFormat = exports.getCaretWithOffset = exports.getCaretBoundaries = void 0;\r\nvar _math = require(\"../../core/utils/math\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _number = _interopRequireDefault(require(\"../../localization/number\"));\r\nvar _utils = require(\"./utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar getCaretBoundaries = function(text, format) {\r\n    if (\"string\" === typeof format) {\r\n        var signParts = format.split(\";\");\r\n        var sign = _number.default.getSign(text, format);\r\n        signParts[1] = signParts[1] || \"-\" + signParts[0];\r\n        format = signParts[sign < 0 ? 1 : 0];\r\n        var mockEscapedStubs = function(str) {\r\n            return str.replace(/'([^']*)'/g, function(str) {\r\n                return str.split(\"\").map(function() {\r\n                    return \" \"\r\n                }).join(\"\").substr(2)\r\n            })\r\n        };\r\n        format = mockEscapedStubs(format);\r\n        var prefixStubLength = /^[^#0.,]*/.exec(format)[0].length;\r\n        var postfixStubLength = /[^#0.,]*$/.exec(format)[0].length;\r\n        return {\r\n            start: prefixStubLength,\r\n            end: text.length - postfixStubLength\r\n        }\r\n    } else {\r\n        return {\r\n            start: 0,\r\n            end: text.length\r\n        }\r\n    }\r\n};\r\nexports.getCaretBoundaries = getCaretBoundaries;\r\nvar _getDigitCountBeforeIndex = function(index, text) {\r\n    var decimalSeparator = _number.default.getDecimalSeparator();\r\n    var regExp = new RegExp(\"[^0-9\" + (0, _common.escapeRegExp)(decimalSeparator) + \"]\", \"g\");\r\n    var textBeforePosition = text.slice(0, index);\r\n    return textBeforePosition.replace(regExp, \"\").length\r\n};\r\nvar _reverseText = function(text) {\r\n    return text.split(\"\").reverse().join(\"\")\r\n};\r\nvar _getDigitPositionByIndex = function(digitIndex, text) {\r\n    if (!digitIndex) {\r\n        return -1\r\n    }\r\n    var regExp = /[0-9]/g;\r\n    var counter = 1;\r\n    var index = null;\r\n    var result = regExp.exec(text);\r\n    while (result) {\r\n        index = result.index;\r\n        if (!digitIndex || counter >= digitIndex) {\r\n            return index\r\n        }\r\n        counter++;\r\n        result = regExp.exec(text)\r\n    }\r\n    return null === index ? text.length : index\r\n};\r\nvar _trimNonNumericCharsFromEnd = function(text) {\r\n    return text.replace(/[^0-9e]+$/, \"\")\r\n};\r\nvar getCaretWithOffset = function(caret, offset) {\r\n    if (void 0 === caret.start) {\r\n        caret = {\r\n            start: caret,\r\n            end: caret\r\n        }\r\n    }\r\n    return {\r\n        start: caret.start + offset,\r\n        end: caret.end + offset\r\n    }\r\n};\r\nexports.getCaretWithOffset = getCaretWithOffset;\r\nvar getCaretAfterFormat = function(text, formatted, caret, format) {\r\n    caret = getCaretWithOffset(caret, 0);\r\n    var point = _number.default.getDecimalSeparator();\r\n    var isSeparatorBasedText = isSeparatorBasedString(text);\r\n    var realSeparatorOccurrenceIndex = (0, _utils.getRealSeparatorIndex)(format).occurrence;\r\n    var pointPosition = isSeparatorBasedText ? 0 : (0, _utils.getNthOccurrence)(text, point, realSeparatorOccurrenceIndex);\r\n    var newPointPosition = (0, _utils.getNthOccurrence)(formatted, point, realSeparatorOccurrenceIndex);\r\n    var textParts = (0, _utils.splitByIndex)(text, pointPosition);\r\n    var formattedParts = (0, _utils.splitByIndex)(formatted, newPointPosition);\r\n    var isCaretOnFloat = pointPosition !== -1 && caret.start > pointPosition;\r\n    if (isCaretOnFloat) {\r\n        var relativeIndex = caret.start - pointPosition - 1;\r\n        var digitsBefore = _getDigitCountBeforeIndex(relativeIndex, textParts[1]);\r\n        var newPosition = formattedParts[1] ? newPointPosition + 1 + _getDigitPositionByIndex(digitsBefore, formattedParts[1]) + 1 : formatted.length;\r\n        return getCaretInBoundaries(newPosition, formatted, format)\r\n    } else {\r\n        var formattedIntPart = _trimNonNumericCharsFromEnd(formattedParts[0]);\r\n        var positionFromEnd = textParts[0].length - caret.start;\r\n        var digitsFromEnd = _getDigitCountBeforeIndex(positionFromEnd, _reverseText(textParts[0]));\r\n        var newPositionFromEnd = _getDigitPositionByIndex(digitsFromEnd, _reverseText(formattedIntPart));\r\n        var newPositionFromBegin = formattedIntPart.length - (newPositionFromEnd + 1);\r\n        return getCaretInBoundaries(newPositionFromBegin, formatted, format)\r\n    }\r\n};\r\nexports.getCaretAfterFormat = getCaretAfterFormat;\r\n\r\nfunction isSeparatorBasedString(text) {\r\n    return 1 === text.length && !!text.match(/^[,.][0-9]*$/g)\r\n}\r\nvar isCaretInBoundaries = function(caret, text, format) {\r\n    caret = getCaretWithOffset(caret, 0);\r\n    var boundaries = getCaretInBoundaries(caret, text, format);\r\n    return caret.start >= boundaries.start && caret.end <= boundaries.end\r\n};\r\nexports.isCaretInBoundaries = isCaretInBoundaries;\r\n\r\nfunction getCaretInBoundaries(caret, text, format) {\r\n    caret = getCaretWithOffset(caret, 0);\r\n    var boundaries = getCaretBoundaries(text, format);\r\n    var adjustedCaret = {\r\n        start: (0, _math.fitIntoRange)(caret.start, boundaries.start, boundaries.end),\r\n        end: (0, _math.fitIntoRange)(caret.end, boundaries.start, boundaries.end)\r\n    };\r\n    return adjustedCaret\r\n}\r\nvar getCaretOffset = function(previousText, newText, format) {\r\n    var previousBoundaries = getCaretBoundaries(previousText, format);\r\n    var newBoundaries = getCaretBoundaries(newText, format);\r\n    return newBoundaries.start - previousBoundaries.start\r\n};\r\nexports.getCaretOffset = getCaretOffset;\r\n"]},"metadata":{},"sourceType":"script"}