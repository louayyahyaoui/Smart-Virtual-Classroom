{"ast":null,"code":"/**\r\n * DevExtreme (data/abstract_store.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _class = _interopRequireDefault(require(\"../core/class\"));\n\nvar _events_strategy = require(\"../core/events_strategy\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _errors = _interopRequireDefault(require(\"./errors\"));\n\nvar _utils = _interopRequireDefault(require(\"./utils\"));\n\nvar _data = require(\"../core/utils/data\");\n\nvar _store_helper = _interopRequireDefault(require(\"./store_helper\"));\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nvar _common = require(\"../core/utils/common\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) {\n    return;\n  }\n\n  if (\"string\" === typeof o) {\n    return _arrayLikeToArray(o, minLen);\n  }\n\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n\n  if (\"Object\" === n && o.constructor) {\n    n = o.constructor.name;\n  }\n\n  if (\"Map\" === n || \"Set\" === n) {\n    return Array.from(o);\n  }\n\n  if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\n    return _arrayLikeToArray(o, minLen);\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    return _arrayLikeToArray(arr);\n  }\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (null == len || len > arr.length) {\n    len = arr.length;\n  }\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nvar abstract = _class.default.abstract;\nvar queryByOptions = _store_helper.default.queryByOptions;\nvar storeImpl = {};\n\nvar Store = _class.default.inherit({\n  ctor: function (options) {\n    var that = this;\n    options = options || {};\n    this._eventsStrategy = new _events_strategy.EventsStrategy(this);\n    (0, _iterator.each)([\"onLoaded\", \"onLoading\", \"onInserted\", \"onInserting\", \"onUpdated\", \"onUpdating\", \"onPush\", \"onRemoved\", \"onRemoving\", \"onModified\", \"onModifying\"], function (_, optionName) {\n      if (optionName in options) {\n        that.on(optionName.slice(2).toLowerCase(), options[optionName]);\n      }\n    });\n    this._key = options.key;\n    this._errorHandler = options.errorHandler;\n    this._useDefaultSearch = true;\n  },\n  _customLoadOptions: function () {\n    return null;\n  },\n  key: function () {\n    return this._key;\n  },\n  keyOf: function (obj) {\n    if (!this._keyGetter) {\n      this._keyGetter = (0, _data.compileGetter)(this.key());\n    }\n\n    return this._keyGetter(obj);\n  },\n  _requireKey: function () {\n    if (!this.key()) {\n      throw _errors.default.errors.Error(\"E4005\");\n    }\n  },\n  load: function (options) {\n    var that = this;\n    options = options || {};\n\n    this._eventsStrategy.fireEvent(\"loading\", [options]);\n\n    return this._withLock(this._loadImpl(options)).done(function (result) {\n      that._eventsStrategy.fireEvent(\"loaded\", [result, options]);\n    });\n  },\n  _loadImpl: function (options) {\n    return queryByOptions(this.createQuery(options), options).enumerate();\n  },\n  _withLock: function (task) {\n    var result = new _deferred.Deferred();\n    task.done(function () {\n      var that = this;\n      var args = arguments;\n\n      _utils.default.processRequestResultLock.promise().done(function () {\n        result.resolveWith(that, args);\n      });\n    }).fail(function () {\n      result.rejectWith(this, arguments);\n    });\n    return result;\n  },\n  createQuery: abstract,\n  totalCount: function (options) {\n    return this._totalCountImpl(options);\n  },\n  _totalCountImpl: function (options) {\n    return queryByOptions(this.createQuery(options), options, true).count();\n  },\n  byKey: function (key, extraOptions) {\n    return this._addFailHandlers(this._withLock(this._byKeyImpl(key, extraOptions)));\n  },\n  _byKeyImpl: abstract,\n  insert: function (values) {\n    var that = this;\n\n    that._eventsStrategy.fireEvent(\"modifying\");\n\n    that._eventsStrategy.fireEvent(\"inserting\", [values]);\n\n    return that._addFailHandlers(that._insertImpl(values).done(function (callbackValues, callbackKey) {\n      that._eventsStrategy.fireEvent(\"inserted\", [callbackValues, callbackKey]);\n\n      that._eventsStrategy.fireEvent(\"modified\");\n    }));\n  },\n  _insertImpl: abstract,\n  update: function (key, values) {\n    var that = this;\n\n    that._eventsStrategy.fireEvent(\"modifying\");\n\n    that._eventsStrategy.fireEvent(\"updating\", [key, values]);\n\n    return that._addFailHandlers(that._updateImpl(key, values).done(function () {\n      that._eventsStrategy.fireEvent(\"updated\", [key, values]);\n\n      that._eventsStrategy.fireEvent(\"modified\");\n    }));\n  },\n  _updateImpl: abstract,\n  push: function (changes) {\n    var _this = this;\n\n    var beforePushArgs = {\n      changes: changes,\n      waitFor: []\n    };\n\n    this._eventsStrategy.fireEvent(\"beforePush\", [beforePushArgs]);\n\n    _deferred.when.apply(void 0, _toConsumableArray(beforePushArgs.waitFor)).done(function () {\n      _this._pushImpl(changes);\n\n      _this._eventsStrategy.fireEvent(\"push\", [changes]);\n    });\n  },\n  _pushImpl: _common.noop,\n  remove: function (key) {\n    var that = this;\n\n    that._eventsStrategy.fireEvent(\"modifying\");\n\n    that._eventsStrategy.fireEvent(\"removing\", [key]);\n\n    return that._addFailHandlers(that._removeImpl(key).done(function (callbackKey) {\n      that._eventsStrategy.fireEvent(\"removed\", [callbackKey]);\n\n      that._eventsStrategy.fireEvent(\"modified\");\n    }));\n  },\n  _removeImpl: abstract,\n  _addFailHandlers: function (deferred) {\n    return deferred.fail(this._errorHandler).fail(_errors.default._errorHandler);\n  },\n  on: function (eventName, eventHandler) {\n    this._eventsStrategy.on(eventName, eventHandler);\n\n    return this;\n  },\n  off: function (eventName, eventHandler) {\n    this._eventsStrategy.off(eventName, eventHandler);\n\n    return this;\n  }\n});\n\nStore.create = function (alias, options) {\n  if (!(alias in storeImpl)) {\n    throw _errors.default.errors.Error(\"E4020\", alias);\n  }\n\n  return new storeImpl[alias](options);\n};\n\nStore.registerClass = function (type, alias) {\n  if (alias) {\n    storeImpl[alias] = type;\n  }\n\n  return type;\n};\n\nStore.inherit = function (inheritor) {\n  return function (members, alias) {\n    var type = inheritor.apply(this, [members]);\n    Store.registerClass(type, alias);\n    return type;\n  };\n}(Store.inherit);\n\nvar _default = Store;\nexports.default = _default;\nmodule.exports = exports.default;","map":{"version":3,"sources":["C:/Smart-Virtual-Classroom/client/node_modules/devextreme/data/abstract_store.js"],"names":["exports","default","_class","_interopRequireDefault","require","_events_strategy","_iterator","_errors","_utils","_data","_store_helper","_deferred","_common","obj","__esModule","_toConsumableArray","arr","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","TypeError","o","minLen","_arrayLikeToArray","n","Object","prototype","toString","call","slice","constructor","name","Array","from","test","iter","Symbol","iterator","isArray","len","length","i","arr2","abstract","queryByOptions","storeImpl","Store","inherit","ctor","options","that","_eventsStrategy","EventsStrategy","each","_","optionName","on","toLowerCase","_key","key","_errorHandler","errorHandler","_useDefaultSearch","_customLoadOptions","keyOf","_keyGetter","compileGetter","_requireKey","errors","Error","load","fireEvent","_withLock","_loadImpl","done","result","createQuery","enumerate","task","Deferred","args","arguments","processRequestResultLock","promise","resolveWith","fail","rejectWith","totalCount","_totalCountImpl","count","byKey","extraOptions","_addFailHandlers","_byKeyImpl","insert","values","_insertImpl","callbackValues","callbackKey","update","_updateImpl","push","changes","_this","beforePushArgs","waitFor","when","apply","_pushImpl","noop","remove","_removeImpl","deferred","eventName","eventHandler","off","create","alias","registerClass","type","inheritor","members","_default","module"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAA,OAAO,CAACC,OAAR,GAAkB,KAAK,CAAvB;;AACA,IAAIC,MAAM,GAAGC,sBAAsB,CAACC,OAAO,CAAC,eAAD,CAAR,CAAnC;;AACA,IAAIC,gBAAgB,GAAGD,OAAO,CAAC,yBAAD,CAA9B;;AACA,IAAIE,SAAS,GAAGF,OAAO,CAAC,wBAAD,CAAvB;;AACA,IAAIG,OAAO,GAAGJ,sBAAsB,CAACC,OAAO,CAAC,UAAD,CAAR,CAApC;;AACA,IAAII,MAAM,GAAGL,sBAAsB,CAACC,OAAO,CAAC,SAAD,CAAR,CAAnC;;AACA,IAAIK,KAAK,GAAGL,OAAO,CAAC,oBAAD,CAAnB;;AACA,IAAIM,aAAa,GAAGP,sBAAsB,CAACC,OAAO,CAAC,gBAAD,CAAR,CAA1C;;AACA,IAAIO,SAAS,GAAGP,OAAO,CAAC,wBAAD,CAAvB;;AACA,IAAIQ,OAAO,GAAGR,OAAO,CAAC,sBAAD,CAArB;;AAEA,SAASD,sBAAT,CAAgCU,GAAhC,EAAqC;AACjC,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AACjC,eAAWA;AADsB,GAArC;AAGH;;AAED,SAASE,kBAAT,CAA4BC,GAA5B,EAAiC;AAC7B,SAAOC,kBAAkB,CAACD,GAAD,CAAlB,IAA2BE,gBAAgB,CAACF,GAAD,CAA3C,IAAoDG,2BAA2B,CAACH,GAAD,CAA/E,IAAwFI,kBAAkB,EAAjH;AACH;;AAED,SAASA,kBAAT,GAA8B;AAC1B,QAAM,IAAIC,SAAJ,CAAc,sIAAd,CAAN;AACH;;AAED,SAASF,2BAAT,CAAqCG,CAArC,EAAwCC,MAAxC,EAAgD;AAC5C,MAAI,CAACD,CAAL,EAAQ;AACJ;AACH;;AACD,MAAI,aAAa,OAAOA,CAAxB,EAA2B;AACvB,WAAOE,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AACH;;AACD,MAAIE,CAAC,GAAGC,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+BP,CAA/B,EAAkCQ,KAAlC,CAAwC,CAAxC,EAA2C,CAAC,CAA5C,CAAR;;AACA,MAAI,aAAaL,CAAb,IAAkBH,CAAC,CAACS,WAAxB,EAAqC;AACjCN,IAAAA,CAAC,GAAGH,CAAC,CAACS,WAAF,CAAcC,IAAlB;AACH;;AACD,MAAI,UAAUP,CAAV,IAAe,UAAUA,CAA7B,EAAgC;AAC5B,WAAOQ,KAAK,CAACC,IAAN,CAAWZ,CAAX,CAAP;AACH;;AACD,MAAI,gBAAgBG,CAAhB,IAAqB,2CAA2CU,IAA3C,CAAgDV,CAAhD,CAAzB,EAA6E;AACzE,WAAOD,iBAAiB,CAACF,CAAD,EAAIC,MAAJ,CAAxB;AACH;AACJ;;AAED,SAASL,gBAAT,CAA0BkB,IAA1B,EAAgC;AAC5B,MAAI,gBAAgB,OAAOC,MAAvB,IAAiCA,MAAM,CAACC,QAAP,IAAmBZ,MAAM,CAACU,IAAD,CAA9D,EAAsE;AAClE,WAAOH,KAAK,CAACC,IAAN,CAAWE,IAAX,CAAP;AACH;AACJ;;AAED,SAASnB,kBAAT,CAA4BD,GAA5B,EAAiC;AAC7B,MAAIiB,KAAK,CAACM,OAAN,CAAcvB,GAAd,CAAJ,EAAwB;AACpB,WAAOQ,iBAAiB,CAACR,GAAD,CAAxB;AACH;AACJ;;AAED,SAASQ,iBAAT,CAA2BR,GAA3B,EAAgCwB,GAAhC,EAAqC;AACjC,MAAI,QAAQA,GAAR,IAAeA,GAAG,GAAGxB,GAAG,CAACyB,MAA7B,EAAqC;AACjCD,IAAAA,GAAG,GAAGxB,GAAG,CAACyB,MAAV;AACH;;AACD,OAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,IAAI,GAAG,IAAIV,KAAJ,CAAUO,GAAV,CAAvB,EAAuCE,CAAC,GAAGF,GAA3C,EAAgDE,CAAC,EAAjD,EAAqD;AACjDC,IAAAA,IAAI,CAACD,CAAD,CAAJ,GAAU1B,GAAG,CAAC0B,CAAD,CAAb;AACH;;AACD,SAAOC,IAAP;AACH;;AACD,IAAIC,QAAQ,GAAG1C,MAAM,CAACD,OAAP,CAAe2C,QAA9B;AACA,IAAIC,cAAc,GAAGnC,aAAa,CAACT,OAAd,CAAsB4C,cAA3C;AACA,IAAIC,SAAS,GAAG,EAAhB;;AACA,IAAIC,KAAK,GAAG7C,MAAM,CAACD,OAAP,CAAe+C,OAAf,CAAuB;AAC/BC,EAAAA,IAAI,EAAE,UAASC,OAAT,EAAkB;AACpB,QAAIC,IAAI,GAAG,IAAX;AACAD,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;AACA,SAAKE,eAAL,GAAuB,IAAI/C,gBAAgB,CAACgD,cAArB,CAAoC,IAApC,CAAvB;AACA,KAAC,GAAG/C,SAAS,CAACgD,IAAd,EAAoB,CAAC,UAAD,EAAa,WAAb,EAA0B,YAA1B,EAAwC,aAAxC,EAAuD,WAAvD,EAAoE,YAApE,EAAkF,QAAlF,EAA4F,WAA5F,EAAyG,YAAzG,EAAuH,YAAvH,EAAqI,aAArI,CAApB,EAAyK,UAASC,CAAT,EAAYC,UAAZ,EAAwB;AAC7L,UAAIA,UAAU,IAAIN,OAAlB,EAA2B;AACvBC,QAAAA,IAAI,CAACM,EAAL,CAAQD,UAAU,CAAC1B,KAAX,CAAiB,CAAjB,EAAoB4B,WAApB,EAAR,EAA2CR,OAAO,CAACM,UAAD,CAAlD;AACH;AACJ,KAJD;AAKA,SAAKG,IAAL,GAAYT,OAAO,CAACU,GAApB;AACA,SAAKC,aAAL,GAAqBX,OAAO,CAACY,YAA7B;AACA,SAAKC,iBAAL,GAAyB,IAAzB;AACH,GAb8B;AAc/BC,EAAAA,kBAAkB,EAAE,YAAW;AAC3B,WAAO,IAAP;AACH,GAhB8B;AAiB/BJ,EAAAA,GAAG,EAAE,YAAW;AACZ,WAAO,KAAKD,IAAZ;AACH,GAnB8B;AAoB/BM,EAAAA,KAAK,EAAE,UAASpD,GAAT,EAAc;AACjB,QAAI,CAAC,KAAKqD,UAAV,EAAsB;AAClB,WAAKA,UAAL,GAAkB,CAAC,GAAGzD,KAAK,CAAC0D,aAAV,EAAyB,KAAKP,GAAL,EAAzB,CAAlB;AACH;;AACD,WAAO,KAAKM,UAAL,CAAgBrD,GAAhB,CAAP;AACH,GAzB8B;AA0B/BuD,EAAAA,WAAW,EAAE,YAAW;AACpB,QAAI,CAAC,KAAKR,GAAL,EAAL,EAAiB;AACb,YAAMrD,OAAO,CAACN,OAAR,CAAgBoE,MAAhB,CAAuBC,KAAvB,CAA6B,OAA7B,CAAN;AACH;AACJ,GA9B8B;AA+B/BC,EAAAA,IAAI,EAAE,UAASrB,OAAT,EAAkB;AACpB,QAAIC,IAAI,GAAG,IAAX;AACAD,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AACA,SAAKE,eAAL,CAAqBoB,SAArB,CAA+B,SAA/B,EAA0C,CAACtB,OAAD,CAA1C;;AACA,WAAO,KAAKuB,SAAL,CAAe,KAAKC,SAAL,CAAexB,OAAf,CAAf,EAAwCyB,IAAxC,CAA6C,UAASC,MAAT,EAAiB;AACjEzB,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,QAA/B,EAAyC,CAACI,MAAD,EAAS1B,OAAT,CAAzC;AACH,KAFM,CAAP;AAGH,GAtC8B;AAuC/BwB,EAAAA,SAAS,EAAE,UAASxB,OAAT,EAAkB;AACzB,WAAOL,cAAc,CAAC,KAAKgC,WAAL,CAAiB3B,OAAjB,CAAD,EAA4BA,OAA5B,CAAd,CAAmD4B,SAAnD,EAAP;AACH,GAzC8B;AA0C/BL,EAAAA,SAAS,EAAE,UAASM,IAAT,EAAe;AACtB,QAAIH,MAAM,GAAG,IAAIjE,SAAS,CAACqE,QAAd,EAAb;AACAD,IAAAA,IAAI,CAACJ,IAAL,CAAU,YAAW;AACjB,UAAIxB,IAAI,GAAG,IAAX;AACA,UAAI8B,IAAI,GAAGC,SAAX;;AACA1E,MAAAA,MAAM,CAACP,OAAP,CAAekF,wBAAf,CAAwCC,OAAxC,GAAkDT,IAAlD,CAAuD,YAAW;AAC9DC,QAAAA,MAAM,CAACS,WAAP,CAAmBlC,IAAnB,EAAyB8B,IAAzB;AACH,OAFD;AAGH,KAND,EAMGK,IANH,CAMQ,YAAW;AACfV,MAAAA,MAAM,CAACW,UAAP,CAAkB,IAAlB,EAAwBL,SAAxB;AACH,KARD;AASA,WAAON,MAAP;AACH,GAtD8B;AAuD/BC,EAAAA,WAAW,EAAEjC,QAvDkB;AAwD/B4C,EAAAA,UAAU,EAAE,UAAStC,OAAT,EAAkB;AAC1B,WAAO,KAAKuC,eAAL,CAAqBvC,OAArB,CAAP;AACH,GA1D8B;AA2D/BuC,EAAAA,eAAe,EAAE,UAASvC,OAAT,EAAkB;AAC/B,WAAOL,cAAc,CAAC,KAAKgC,WAAL,CAAiB3B,OAAjB,CAAD,EAA4BA,OAA5B,EAAqC,IAArC,CAAd,CAAyDwC,KAAzD,EAAP;AACH,GA7D8B;AA8D/BC,EAAAA,KAAK,EAAE,UAAS/B,GAAT,EAAcgC,YAAd,EAA4B;AAC/B,WAAO,KAAKC,gBAAL,CAAsB,KAAKpB,SAAL,CAAe,KAAKqB,UAAL,CAAgBlC,GAAhB,EAAqBgC,YAArB,CAAf,CAAtB,CAAP;AACH,GAhE8B;AAiE/BE,EAAAA,UAAU,EAAElD,QAjEmB;AAkE/BmD,EAAAA,MAAM,EAAE,UAASC,MAAT,EAAiB;AACrB,QAAI7C,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,WAA/B;;AACArB,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,WAA/B,EAA4C,CAACwB,MAAD,CAA5C;;AACA,WAAO7C,IAAI,CAAC0C,gBAAL,CAAsB1C,IAAI,CAAC8C,WAAL,CAAiBD,MAAjB,EAAyBrB,IAAzB,CAA8B,UAASuB,cAAT,EAAyBC,WAAzB,EAAsC;AAC7FhD,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B,EAA2C,CAAC0B,cAAD,EAAiBC,WAAjB,CAA3C;;AACAhD,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B;AACH,KAH4B,CAAtB,CAAP;AAIH,GA1E8B;AA2E/ByB,EAAAA,WAAW,EAAErD,QA3EkB;AA4E/BwD,EAAAA,MAAM,EAAE,UAASxC,GAAT,EAAcoC,MAAd,EAAsB;AAC1B,QAAI7C,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,WAA/B;;AACArB,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B,EAA2C,CAACZ,GAAD,EAAMoC,MAAN,CAA3C;;AACA,WAAO7C,IAAI,CAAC0C,gBAAL,CAAsB1C,IAAI,CAACkD,WAAL,CAAiBzC,GAAjB,EAAsBoC,MAAtB,EAA8BrB,IAA9B,CAAmC,YAAW;AACvExB,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,SAA/B,EAA0C,CAACZ,GAAD,EAAMoC,MAAN,CAA1C;;AACA7C,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B;AACH,KAH4B,CAAtB,CAAP;AAIH,GApF8B;AAqF/B6B,EAAAA,WAAW,EAAEzD,QArFkB;AAsF/B0D,EAAAA,IAAI,EAAE,UAASC,OAAT,EAAkB;AACpB,QAAIC,KAAK,GAAG,IAAZ;;AACA,QAAIC,cAAc,GAAG;AACjBF,MAAAA,OAAO,EAAEA,OADQ;AAEjBG,MAAAA,OAAO,EAAE;AAFQ,KAArB;;AAIA,SAAKtD,eAAL,CAAqBoB,SAArB,CAA+B,YAA/B,EAA6C,CAACiC,cAAD,CAA7C;;AACA9F,IAAAA,SAAS,CAACgG,IAAV,CAAeC,KAAf,CAAqB,KAAK,CAA1B,EAA6B7F,kBAAkB,CAAC0F,cAAc,CAACC,OAAhB,CAA/C,EAAyE/B,IAAzE,CAA8E,YAAW;AACrF6B,MAAAA,KAAK,CAACK,SAAN,CAAgBN,OAAhB;;AACAC,MAAAA,KAAK,CAACpD,eAAN,CAAsBoB,SAAtB,CAAgC,MAAhC,EAAwC,CAAC+B,OAAD,CAAxC;AACH,KAHD;AAIH,GAjG8B;AAkG/BM,EAAAA,SAAS,EAAEjG,OAAO,CAACkG,IAlGY;AAmG/BC,EAAAA,MAAM,EAAE,UAASnD,GAAT,EAAc;AAClB,QAAIT,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,WAA/B;;AACArB,IAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B,EAA2C,CAACZ,GAAD,CAA3C;;AACA,WAAOT,IAAI,CAAC0C,gBAAL,CAAsB1C,IAAI,CAAC6D,WAAL,CAAiBpD,GAAjB,EAAsBe,IAAtB,CAA2B,UAASwB,WAAT,EAAsB;AAC1EhD,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,SAA/B,EAA0C,CAAC2B,WAAD,CAA1C;;AACAhD,MAAAA,IAAI,CAACC,eAAL,CAAqBoB,SAArB,CAA+B,UAA/B;AACH,KAH4B,CAAtB,CAAP;AAIH,GA3G8B;AA4G/BwC,EAAAA,WAAW,EAAEpE,QA5GkB;AA6G/BiD,EAAAA,gBAAgB,EAAE,UAASoB,QAAT,EAAmB;AACjC,WAAOA,QAAQ,CAAC3B,IAAT,CAAc,KAAKzB,aAAnB,EAAkCyB,IAAlC,CAAuC/E,OAAO,CAACN,OAAR,CAAgB4D,aAAvD,CAAP;AACH,GA/G8B;AAgH/BJ,EAAAA,EAAE,EAAE,UAASyD,SAAT,EAAoBC,YAApB,EAAkC;AAClC,SAAK/D,eAAL,CAAqBK,EAArB,CAAwByD,SAAxB,EAAmCC,YAAnC;;AACA,WAAO,IAAP;AACH,GAnH8B;AAoH/BC,EAAAA,GAAG,EAAE,UAASF,SAAT,EAAoBC,YAApB,EAAkC;AACnC,SAAK/D,eAAL,CAAqBgE,GAArB,CAAyBF,SAAzB,EAAoCC,YAApC;;AACA,WAAO,IAAP;AACH;AAvH8B,CAAvB,CAAZ;;AAyHApE,KAAK,CAACsE,MAAN,GAAe,UAASC,KAAT,EAAgBpE,OAAhB,EAAyB;AACpC,MAAI,EAAEoE,KAAK,IAAIxE,SAAX,CAAJ,EAA2B;AACvB,UAAMvC,OAAO,CAACN,OAAR,CAAgBoE,MAAhB,CAAuBC,KAAvB,CAA6B,OAA7B,EAAsCgD,KAAtC,CAAN;AACH;;AACD,SAAO,IAAIxE,SAAS,CAACwE,KAAD,CAAb,CAAqBpE,OAArB,CAAP;AACH,CALD;;AAMAH,KAAK,CAACwE,aAAN,GAAsB,UAASC,IAAT,EAAeF,KAAf,EAAsB;AACxC,MAAIA,KAAJ,EAAW;AACPxE,IAAAA,SAAS,CAACwE,KAAD,CAAT,GAAmBE,IAAnB;AACH;;AACD,SAAOA,IAAP;AACH,CALD;;AAMAzE,KAAK,CAACC,OAAN,GAAgB,UAASyE,SAAT,EAAoB;AAChC,SAAO,UAASC,OAAT,EAAkBJ,KAAlB,EAAyB;AAC5B,QAAIE,IAAI,GAAGC,SAAS,CAACb,KAAV,CAAgB,IAAhB,EAAsB,CAACc,OAAD,CAAtB,CAAX;AACA3E,IAAAA,KAAK,CAACwE,aAAN,CAAoBC,IAApB,EAA0BF,KAA1B;AACA,WAAOE,IAAP;AACH,GAJD;AAKH,CANe,CAMdzE,KAAK,CAACC,OANQ,CAAhB;;AAOA,IAAI2E,QAAQ,GAAG5E,KAAf;AACA/C,OAAO,CAACC,OAAR,GAAkB0H,QAAlB;AACAC,MAAM,CAAC5H,OAAP,GAAiBA,OAAO,CAACC,OAAzB","sourcesContent":["/**\r\n * DevExtreme (data/abstract_store.js)\r\n * Version: 20.2.6\r\n * Build date: Tue Mar 16 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _class = _interopRequireDefault(require(\"../core/class\"));\r\nvar _events_strategy = require(\"../core/events_strategy\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _errors = _interopRequireDefault(require(\"./errors\"));\r\nvar _utils = _interopRequireDefault(require(\"./utils\"));\r\nvar _data = require(\"../core/utils/data\");\r\nvar _store_helper = _interopRequireDefault(require(\"./store_helper\"));\r\nvar _deferred = require(\"../core/utils/deferred\");\r\nvar _common = require(\"../core/utils/common\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")\r\n}\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) {\r\n    if (!o) {\r\n        return\r\n    }\r\n    if (\"string\" === typeof o) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n    var n = Object.prototype.toString.call(o).slice(8, -1);\r\n    if (\"Object\" === n && o.constructor) {\r\n        n = o.constructor.name\r\n    }\r\n    if (\"Map\" === n || \"Set\" === n) {\r\n        return Array.from(o)\r\n    }\r\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) {\r\n        return _arrayLikeToArray(o, minLen)\r\n    }\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (\"undefined\" !== typeof Symbol && Symbol.iterator in Object(iter)) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return _arrayLikeToArray(arr)\r\n    }\r\n}\r\n\r\nfunction _arrayLikeToArray(arr, len) {\r\n    if (null == len || len > arr.length) {\r\n        len = arr.length\r\n    }\r\n    for (var i = 0, arr2 = new Array(len); i < len; i++) {\r\n        arr2[i] = arr[i]\r\n    }\r\n    return arr2\r\n}\r\nvar abstract = _class.default.abstract;\r\nvar queryByOptions = _store_helper.default.queryByOptions;\r\nvar storeImpl = {};\r\nvar Store = _class.default.inherit({\r\n    ctor: function(options) {\r\n        var that = this;\r\n        options = options || {};\r\n        this._eventsStrategy = new _events_strategy.EventsStrategy(this);\r\n        (0, _iterator.each)([\"onLoaded\", \"onLoading\", \"onInserted\", \"onInserting\", \"onUpdated\", \"onUpdating\", \"onPush\", \"onRemoved\", \"onRemoving\", \"onModified\", \"onModifying\"], function(_, optionName) {\r\n            if (optionName in options) {\r\n                that.on(optionName.slice(2).toLowerCase(), options[optionName])\r\n            }\r\n        });\r\n        this._key = options.key;\r\n        this._errorHandler = options.errorHandler;\r\n        this._useDefaultSearch = true\r\n    },\r\n    _customLoadOptions: function() {\r\n        return null\r\n    },\r\n    key: function() {\r\n        return this._key\r\n    },\r\n    keyOf: function(obj) {\r\n        if (!this._keyGetter) {\r\n            this._keyGetter = (0, _data.compileGetter)(this.key())\r\n        }\r\n        return this._keyGetter(obj)\r\n    },\r\n    _requireKey: function() {\r\n        if (!this.key()) {\r\n            throw _errors.default.errors.Error(\"E4005\")\r\n        }\r\n    },\r\n    load: function(options) {\r\n        var that = this;\r\n        options = options || {};\r\n        this._eventsStrategy.fireEvent(\"loading\", [options]);\r\n        return this._withLock(this._loadImpl(options)).done(function(result) {\r\n            that._eventsStrategy.fireEvent(\"loaded\", [result, options])\r\n        })\r\n    },\r\n    _loadImpl: function(options) {\r\n        return queryByOptions(this.createQuery(options), options).enumerate()\r\n    },\r\n    _withLock: function(task) {\r\n        var result = new _deferred.Deferred;\r\n        task.done(function() {\r\n            var that = this;\r\n            var args = arguments;\r\n            _utils.default.processRequestResultLock.promise().done(function() {\r\n                result.resolveWith(that, args)\r\n            })\r\n        }).fail(function() {\r\n            result.rejectWith(this, arguments)\r\n        });\r\n        return result\r\n    },\r\n    createQuery: abstract,\r\n    totalCount: function(options) {\r\n        return this._totalCountImpl(options)\r\n    },\r\n    _totalCountImpl: function(options) {\r\n        return queryByOptions(this.createQuery(options), options, true).count()\r\n    },\r\n    byKey: function(key, extraOptions) {\r\n        return this._addFailHandlers(this._withLock(this._byKeyImpl(key, extraOptions)))\r\n    },\r\n    _byKeyImpl: abstract,\r\n    insert: function(values) {\r\n        var that = this;\r\n        that._eventsStrategy.fireEvent(\"modifying\");\r\n        that._eventsStrategy.fireEvent(\"inserting\", [values]);\r\n        return that._addFailHandlers(that._insertImpl(values).done(function(callbackValues, callbackKey) {\r\n            that._eventsStrategy.fireEvent(\"inserted\", [callbackValues, callbackKey]);\r\n            that._eventsStrategy.fireEvent(\"modified\")\r\n        }))\r\n    },\r\n    _insertImpl: abstract,\r\n    update: function(key, values) {\r\n        var that = this;\r\n        that._eventsStrategy.fireEvent(\"modifying\");\r\n        that._eventsStrategy.fireEvent(\"updating\", [key, values]);\r\n        return that._addFailHandlers(that._updateImpl(key, values).done(function() {\r\n            that._eventsStrategy.fireEvent(\"updated\", [key, values]);\r\n            that._eventsStrategy.fireEvent(\"modified\")\r\n        }))\r\n    },\r\n    _updateImpl: abstract,\r\n    push: function(changes) {\r\n        var _this = this;\r\n        var beforePushArgs = {\r\n            changes: changes,\r\n            waitFor: []\r\n        };\r\n        this._eventsStrategy.fireEvent(\"beforePush\", [beforePushArgs]);\r\n        _deferred.when.apply(void 0, _toConsumableArray(beforePushArgs.waitFor)).done(function() {\r\n            _this._pushImpl(changes);\r\n            _this._eventsStrategy.fireEvent(\"push\", [changes])\r\n        })\r\n    },\r\n    _pushImpl: _common.noop,\r\n    remove: function(key) {\r\n        var that = this;\r\n        that._eventsStrategy.fireEvent(\"modifying\");\r\n        that._eventsStrategy.fireEvent(\"removing\", [key]);\r\n        return that._addFailHandlers(that._removeImpl(key).done(function(callbackKey) {\r\n            that._eventsStrategy.fireEvent(\"removed\", [callbackKey]);\r\n            that._eventsStrategy.fireEvent(\"modified\")\r\n        }))\r\n    },\r\n    _removeImpl: abstract,\r\n    _addFailHandlers: function(deferred) {\r\n        return deferred.fail(this._errorHandler).fail(_errors.default._errorHandler)\r\n    },\r\n    on: function(eventName, eventHandler) {\r\n        this._eventsStrategy.on(eventName, eventHandler);\r\n        return this\r\n    },\r\n    off: function(eventName, eventHandler) {\r\n        this._eventsStrategy.off(eventName, eventHandler);\r\n        return this\r\n    }\r\n});\r\nStore.create = function(alias, options) {\r\n    if (!(alias in storeImpl)) {\r\n        throw _errors.default.errors.Error(\"E4020\", alias)\r\n    }\r\n    return new storeImpl[alias](options)\r\n};\r\nStore.registerClass = function(type, alias) {\r\n    if (alias) {\r\n        storeImpl[alias] = type\r\n    }\r\n    return type\r\n};\r\nStore.inherit = function(inheritor) {\r\n    return function(members, alias) {\r\n        var type = inheritor.apply(this, [members]);\r\n        Store.registerClass(type, alias);\r\n        return type\r\n    }\r\n}(Store.inherit);\r\nvar _default = Store;\r\nexports.default = _default;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}